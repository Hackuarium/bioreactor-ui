(this["webpackJsonpbioreactor-ui"]=this["webpackJsonpbioreactor-ui"]||[]).push([[8],{105:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return d})),n.d(t,"a",(function(){return f})),n.d(t,"e",(function(){return m}));var r=n(3),c=n(113),o=n.n(c),i=["events","parameters"],a="BIOREACTOR-UI_devices",u="https:"===window.location.protocol?"443":"80",s="https:"===window.location.protocol?"wss":"http",l=["http","tcp","wss"],d={broadcast:"broadcast",interactive:"interactive",local:"local"},f={help:"h",settings:"u",compactSettings:"uc",runExperiment:"r",kinetic:"k",reset:"ur1234",sleep:"l",setParameter:function(e,t){return"".concat(e).concat(t)}},m=Object.keys(o.a).filter((function(e){return o.a[e].kind})).map((function(e){var t=o.a[e];t.events,t.parameters;return Object(r.a)(t,i)}))},109:function(e,t,n){"use strict";n.d(t,"d",(function(){return f})),n.d(t,"g",(function(){return m})),n.d(t,"n",(function(){return b})),n.d(t,"h",(function(){return j})),n.d(t,"f",(function(){return v})),n.d(t,"p",(function(){return p})),n.d(t,"e",(function(){return O})),n.d(t,"a",(function(){return x})),n.d(t,"o",(function(){return h})),n.d(t,"j",(function(){return w})),n.d(t,"k",(function(){return g})),n.d(t,"l",(function(){return k})),n.d(t,"i",(function(){return N})),n.d(t,"b",(function(){return y})),n.d(t,"m",(function(){return _})),n.d(t,"c",(function(){return C}));var r=n(54),c=n.n(r),o=n(59),i=n(1),a=n(113),u=n.n(a),s=n(116),l=n(105),d=function(e,t){console.log(e);var n=new Error("".concat(t," \n").concat(null===e||void 0===e?void 0:e.message));throw n.name="DATABASE_ERROR",n},f=function(e,t,n){return"".concat(e,"_").concat(t,"_").concat(n)},m=function(e){try{if(e)return u.a.fromDeviceID(Number(e))}catch(t){return void console.log(t)}},b=function(e,t){var n,r;return e&&t?null===(n=u.a[e])||void 0===n||null===(r=n.parameters)||void 0===r?void 0:r.map((function(e){return Object(i.a)(Object(i.a)({},e),{},{value:t[e.label]})})):void 0},j=function(){var e=Object(o.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(s.a)(l.d).getAll({startkey:"".concat(t),endkey:"".concat(t,"\uffff")}).then((function(e){return e.rows.map((function(e){return e.doc}))})).catch((function(e){return d(e,"Get locally saved devices error")})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=Object(o.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(s.a)(l.d).get(t).catch((function(e){return d(e,"Get device error")})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(o.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(s.a)(l.d).update(t).catch((function(e){return d(e,"Update device error")})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),O=function(e){return Object(s.a)(l.d).remove(e).catch((function(e){return d(e,"Delete device error")}))},x=function(e){return Object(s.a)(l.d).put(e).catch((function(e){return"conflict"===e.name?d(e,"Device name must be unique"):d(e,"Insert device error")}))},h=function(e,t){return Object(s.a)(e).put(Object(i.a)({_id:Date.now().toString()},t))},w=function(e){return Object(s.a)(e).getAll({descending:!0}).then((function(e){return e.rows.map((function(e){return e.doc}))}))},g=function(e,t,n){return Object(s.a)(e).getAll({descending:!0,skip:(t-1)*n,limit:n}).then((function(e){return e.rows.map((function(e){return e.doc}))}))},k=function(e){return Object(s.a)(e).getAll({include_docs:!1}).then((function(e){return e.total_rows}))},N=function(e){return Object(s.a)(e).getAll({descending:!0,limit:1}).then((function(e){return e.rows.map((function(e){return e.doc}))}))},y=function(e){return Object(s.a)(e).destroy()},_=function(e,t,n){return Object(s.a)(e).listenToChanges(t,n)},C=function(e){return Object(s.a)(e).close()}},116:function(e,t,n){"use strict";var r=n(54),c=n.n(r),o=n(1),i=n(59),a=n(140),u={};t.a=function(e){var t=function(){return e in u||(u[e]=new a.a(e,{revs_limit:1,auto_compaction:!0})),u[e]};return{getInfo:function(){return new Promise((function(e,n){t().info().then((function(t){return e(t)})).catch((function(e){return n(e)}))}))},getAll:function(){var e=Object(i.a)(c.a.mark((function e(n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){t().allDocs(Object(o.a)({include_docs:!0},n)).then((function(t){return e(t)})).catch((function(e){return r(e)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),get:function(e){return new Promise((function(n,r){var c=t();e?c.get(e).then((function(e){return n(e)})).catch((function(e){return r(e)})):r(new Error("Doc fetch : docId is required"))}))},put:function(e){return new Promise((function(n,r){var c=t();"_id"in e?c.put(e).then((function(e){return n(e)})).catch((function(e){return r(e)})):r(new Error("Doc create : _id is required in doc"))}))},update:function(e){return new Promise((function(n,r){var c=t();"_id"in e?c.get(e._id).then((function(t){return c.put(Object(o.a)(Object(o.a)({},e),{},{_rev:t._rev})).then((function(e){return n(e)})).catch((function(e){return r(e)}))})).catch((function(e){return r(e)})):r(new Error("Doc update : _id is required in doc"))}))},remove:function(e){return new Promise((function(n,r){var c=t();e?c.get(e).then((function(t){return c.remove({_id:e,_rev:t._rev}).then((function(e){return n(e)})).catch((function(e){return r(e)}))})).catch((function(e){return r(e)})):r(new Error("Doc remove : docId is required"))}))},listenToChanges:function(e,n,r){return t().changes(Object(o.a)({since:"now",live:!0,include_docs:!0},r)).on("change",e).on("error",n)},close:function(){var n=t();return delete u[e],n.close()},destroy:function(){var n=t();return delete u[e],n.destroy()}}}},128:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return c}));var r=function(e,t){var n;return e.filter((n=t,function(e){return 0===n.filter((function(t){return t.id===e.id})).length}))},c=function(e){var t=Math.floor(e/1e3%60),n=Math.floor(e/6e4%60),r=Math.floor(e/36e5%24),c="".concat(t,"s");return r?c="".concat(r,"h ").concat(n,"m ")+c:n&&(c="".concat(n,"m ")+c),c}},129:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return O})),n.d(t,"d",(function(){return x})),n.d(t,"c",(function(){return h}));var r=n(54),c=n.n(r),o=n(59),i=n(1),a=n(111),u=n(116),s=n(161),l=n.n(s),d=n(148),f=function(e,t,n,r,c){return new Promise((function(r,c){!function(e,t,n,r,c,o,i){var u="".concat(t,"://").concat(e,":").concat(n),s=l.a.connect(u,{keepalive:300,reconnectPeriod:5e3});s.on("connect",(function(){Object(a.isFunction)(o)&&o(s)})),s.stream.on("error",(function(e){var t=new Error("Couldn't connect to BROKER \"".concat(u,'"'));t.name="Mqtt Error",s.end(),Object(a.isFunction)(i)&&i(t)}))}(e,t,n,0,0,(function(e){return r(e)}),(function(e){return c(e)}))}))},m=function(e,t,n,r){e.subscribe(t,{qos:2},(function(t){t?Object(a.isFunction)(r)&&r(t):e.on("message",(function(e,t){var r;Object(a.isFunction)(n)&&n((r=t,Object(d.parseCurrentSettings)(r.toString(),{})))}))}));return function(n){return e.unsubscribe(t,{},n)}},b=function(e,t){return e.end((function(){Object(a.isFunction)(t)&&t()}))},j=n(105),v=n(109),p=function(e){var t;return Object(i.a)(Object(i.a)({},e),{},{_id:Object(v.d)(j.g.broadcast,null===(t=e.kind)||void 0===t?void 0:t.kind,e.name),protocol:(null===e||void 0===e?void 0:e.protocol)?null===e||void 0===e?void 0:e.protocol:j.c,port:(null===e||void 0===e?void 0:e.port)?null===e||void 0===e?void 0:e.port:j.b})},O=function(e){var t=e._id,n=e.name,r=e.kind,a=e.deviceId,s=void 0===a?t||"".concat(r,"_").concat(n):a,l=e.url,d=e.protocol,v=void 0===d?j.c:d,p=e.port,O=void 0===p?j.b:p,x=e.topic;e.username,e.password;return new Promise(function(){var e=Object(o.a)(c.a.mark((function e(t,n){var r,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f(l,v,O);case 3:r=e.sent,o=Object(u.a)(s),t({subscribe:function(e,t){return m(r,x,(function(t){o.put(Object(i.a)({_id:"".concat(Date.now(),"_").concat(t.epoch)},t)).then((function(){return e(t)})).catch((function(){}))}),t)},disconnect:function(e){return b(r,e)},getAllData:function(){return o.getAll().then((function(e){return e.rows.map((function(e){return e.doc}))}))},getLastData:function(){return o.getAll({descending:!0,limit:1}).then((function(e){return e.rows.map((function(e){return e.doc}))}))},getPageData:function(e,t){return o.getAll({descending:!0,skip:e,limit:t}).then((function(e){return e.rows.map((function(e){return e.doc}))}))},getAllDataCount:function(){return o.getAll().then((function(e){return e.total_rows}))}}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),n(e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,n){return e.apply(this,arguments)}}())},x=function(e){var t=e.url,n=e.protocol,r=void 0===n?j.c:n,i=e.port,a=void 0===i?j.b:i,u=e.topic;e.username,e.password;return new Promise(function(){var e=Object(o.a)(c.a.mark((function e(n,o){var i,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f(t,r,a);case 3:i=e.sent,s=m(i,u,(function(e){s(),b(i,(function(){return n(e)}))}),o),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),o(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}())},h=function(){var e=Object(o.a)(c.a.mark((function e(t,n){var r,i,u,s=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]?s[2]:1e4,(i=function(){var e=Object(o.a)(c.a.mark((function e(){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],t.forEach((function(e){return r.push(x(e).then((function(t){return{device:e,payload:t}})).catch((function(t){throw t.device=e,t})))})),e.t0=Object(a.isFunction)(n),!e.t0){e.next=9;break}return e.t1=n,e.next=7,Promise.allSettled(r);case 7:e.t2=e.sent,(0,e.t1)(e.t2);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}())(),u=setInterval(Object(o.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),r),e.abrupt("return",u);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},141:function(e,t){},151:function(e,t,n){"use strict";var r=n(54),c=n.n(r),o=n(3),i=n(59),a=n(6),u=n(1),s=n(2),l=n(160),d=n(111),f=n(20),m=n(129),b=n(105),j=n(0),v=["kind"],p=b.f.map((function(e){return{label:e.toUpperCase(),value:e}})),O=b.e.map((function(e){return Object(u.a)(Object(u.a)({},e),{},{label:e.name,value:e.kind})})),x=l.b().shape({name:l.c().max(50,"Name too Long!").matches(/^[A-z0-9_-]*$/,"Field supports only : letters / numbers / _ / - ").required("Required"),url:l.c().required("Required"),port:l.a().positive().integer(),protocol:l.c(),kind:l.c().required("Required"),topic:l.c().required("Required"),username:l.c().required("Required")});t.a=function(e){var t=e.isOpen,n=e.onClose,r=e.onSave,l=e.onUpdate,h=e.initialValues,w=!Object(d.isEmpty)(h),g=Object(s.useState)(Object(j.jsx)("div",{})),k=Object(a.a)(g,2),N=k[0],y=k[1],_=Object(s.useRef)(null),C=w?Object(u.a)(Object(u.a)({},h),{},{kind:h.kind.kind}):{name:"Computer_01",url:"mqtt.hackuarium.org",protocol:p.filter((function(e){return e.value===b.c}))[0].value,port:b.b,kind:"Computer",topic:"lpatiny/Computer/server",username:"user",password:"password"};Object(s.useEffect)((function(){!t&&setTimeout((function(){return y(Object(j.jsx)("div",{}))}),500)}),[t]);var q=function(){var e=Object(i.a)(c.a.mark((function e(t){var i,a,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,i=t.kind,a=Object(o.a)(t,v),s=b.e.filter((function(e){return e.kind===i}))[0],!w){e.next=8;break}return e.next=6,l(Object(u.a)(Object(u.a)({},a),{},{kind:s}));case 6:e.next=10;break;case 8:return e.next=10,r(Object(u.a)(Object(u.a)({},a),{},{kind:s}));case 10:n(),e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(0),new Error(e.t0.message);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}(),A=function(e,t){switch(e){case"connecting":y(Object(j.jsxs)("div",{className:"mx-6 flex flex-row items-center text-sm text-left text-neutral-500",children:[Object(j.jsx)(f.n,{className:"w-6 h-6 mr-2"}),Object(j.jsx)("span",{children:t})]}));break;case"success":y(Object(j.jsxs)("div",{className:"mx-4 flex flex-row items-center text-sm text-left text-success-500",children:[Object(j.jsx)(f.r,{className:"h-6 w-6 mr-4"}),Object(j.jsx)("span",{children:t})]}));break;case"error":y(Object(j.jsxs)("div",{className:"mx-4 flex flex-row items-center text-sm text-left text-danger-500",children:[Object(j.jsx)(f.E,{className:"h-6 w-6 mr-4"}),Object(j.jsx)("span",{children:t})]}));break;default:y(Object(j.jsx)("div",{}))}};return Object(j.jsxs)(f.j,{isOpen:t,onRequestClose:n,icon:Object(j.jsx)(f.B,{}),iconColor:"neutral",animated:!0,hasCloseButton:!0,requestCloseOnBackdrop:!0,requestCloseOnEsc:!0,fluid:!0,wrapperComponent:f.f,wrapperProps:{innerRef:_,initialValues:C,validationSchema:x,onSubmit:q,className:"h-full"},children:[Object(j.jsx)(f.j.Header,{children:w?"Update Device":"Connect New Device"}),Object(j.jsxs)(f.j.Body,{children:[Object(j.jsxs)("div",{className:"p-2 mt-2",children:[Object(j.jsx)(f.i,{name:"name",id:"name",label:"Custom name",placeholder:"Device name",disabled:w,required:!0,className:"w-full",inputClassName:"w-full"}),Object(j.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between mt-4 sm:mt-0 border-t border-neutral sm:border-0",children:[Object(j.jsx)(f.i,{name:"url",id:"url",label:"URL",placeholder:"mqtt.domain.com",required:!0,leadingInlineAddon:Object(j.jsx)(f.z,{}),className:"mt-4 sm:mr-4 w-full sm:w-1/2",inputClassName:"w-full"}),Object(j.jsxs)("div",{className:"flex flex-row justify-between items-start flex-1",children:[Object(j.jsx)(f.m,{name:"protocol",id:"protocol",label:"Protocol",options:p,renderOption:function(e){return"".concat(e.label)},getValue:function(e){return e.value},className:"mt-4 mr-4 w-1/2",inputClassName:"w-full"}),Object(j.jsx)(f.i,{name:"port",id:"port",label:"Port",className:"mt-4 flex-1",inputClassName:"w-full"})]})]}),Object(j.jsxs)("div",{className:"flex flex-row justify-between items-start",children:[Object(j.jsx)(f.m,{name:"kind",id:"kind",label:"Kind",options:O,renderOption:function(e){return"".concat(e.label)},getValue:function(e){return e.value},required:!0,className:"mt-4 mr-4 w-1/2 ",inputClassName:"w-full bg-gray-500"}),Object(j.jsx)(f.i,{name:"topic",id:"topic",label:"Topic",required:!0,className:"mt-4 flex-1",inputClassName:"w-full"})]}),Object(j.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between mt-4 sm:mt-0 border-t border-neutral sm:border-0",children:[Object(j.jsx)(f.i,{name:"username",id:"username",label:"Username",placeholder:"Username",required:!0,leadingInlineAddon:Object(j.jsx)(f.D,{}),className:"mt-4 w-full sm:mr-4 sm:w-1/2",inputClassName:"w-full"}),Object(j.jsx)(f.i,{name:"password",id:"password",label:"Password",type:"password",placeholder:"********",required:!0,leadingInlineAddon:Object(j.jsx)(f.y,{}),className:"mt-4 w-full sm:flex-1",inputClassName:"w-full"})]})]}),Object(j.jsx)(f.g,{})]}),Object(j.jsx)(f.j.Footer,{children:Object(j.jsxs)("div",{className:"flex flex-col sm:flex-row items-center",children:[N,Object(j.jsx)("button",{onClick:function(e){e.stopPropagation(),A("connecting","Connecting ..."),setTimeout((function(){Object(m.d)(_.current.values).then((function(){A("success","Connected")})).catch((function(e){A("error","Connection Error: ".concat(e.message))}))}),500)},type:"button",className:"w-full sm:w-max mt-2 sm:my-0 px-4 py-2 sm:mr-4 text-sm font-semibold text-neutral-700 border rounded-md shadow bg-neutral-200 focus:outline-none flex-1 sm:flex-none",children:"Test connection"}),Object(j.jsx)(f.o,{className:"w-full my-2 sm:my-0 sm:w-max ",children:w?"Update":"Add"})]})})]})}},165:function(e,t){},166:function(e,t){},180:function(e,t){},181:function(e,t){},395:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n(6),o=n(2),i=n(111),a=n(20),u=n(29),s=n(109),l=n(128),d=n(0),f=function(e){var t,n=e.device,f=Object(o.useState)([]),m=Object(c.a)(f,2),b=m[0],j=m[1],v=Object(o.useState)([]),p=Object(c.a)(v,2),O=p[0],x=p[1],h=Object(o.useState)(1),w=Object(c.a)(h,2),g=w[0],k=w[1],N=Object(o.useState)(0),y=Object(c.a)(N,2),_=y[0],C=y[1],q=Object(o.useState)(!1),A=Object(c.a)(q,2),E=A[0],P=A[1],S=Object(o.useCallback)((function(e){if(0===b.length&&e&&e.length>0){var t,n,r=null===(t=e[0])||void 0===t||null===(n=t.parametersArray)||void 0===n?void 0:n.map((function(e){return e.name||e.label}));j(["Time"].concat(Object(u.a)(r)))}}),[b.length]),D=Object(o.useCallback)(Object(i.throttle)((function(e){(null===n||void 0===n?void 0:n._id)&&Object(s.k)(null===n||void 0===n?void 0:n._id,e,10).then((function(e){var t=e.map((function(e){var t;return{epoch:Object(l.b)(null===e||void 0===e?void 0:e.epoch),parametersArray:Object(s.n)(null===n||void 0===n||null===(t=n.kind)||void 0===t?void 0:t.kind,null===e||void 0===e?void 0:e.parameters)}}));S(t),x(t),Object(s.l)(null===n||void 0===n?void 0:n._id).then(C)}))}),1e3,{trailing:!0}),[null===n||void 0===n?void 0:n._id,null===n||void 0===n||null===(t=n.kind)||void 0===t?void 0:t.kind,S]);Object(o.useEffect)((function(){var e;return(null===n||void 0===n?void 0:n._id)&&(e=Object(s.m)(null===n||void 0===n?void 0:n._id,(function(e){D(g)}),(function(e){return console.log(e)}))),function(){return e&&e.cancel()}}),[null===n||void 0===n?void 0:n._id,D,g,E]),Object(o.useEffect)((function(){D(g)}),[D,g]);var R=Object(o.useCallback)((function(){return Object(d.jsx)("tr",{children:null===b||void 0===b?void 0:b.map((function(e){return Object(d.jsx)(a.M,{className:"p-2 text-center font-normal normal-case",compact:!0,children:e},e)}))})}),[b]),I=Object(o.useCallback)((function(e){var t,n="text-xs text-center p-2";return Object(d.jsxs)("tr",{children:[Object(d.jsx)(a.L,{compact:!0,className:n+" font-medium",children:e.value.epoch}),null===(t=e.value.parametersArray)||void 0===t?void 0:t.map((function(e,t){return Object(d.jsx)(a.L,{compact:!0,className:n,children:e.value},t)}))]})}),[]);return Object(d.jsxs)("div",{className:"w-full",children:[Object(d.jsx)("div",{className:"w-full p-2 flex flex-row justify-end",children:Object(d.jsx)(a.c,{size:"small",variant:"white",onClick:function(){Object(s.b)(null===n||void 0===n?void 0:n._id).then((function(){Object(s.l)(null===n||void 0===n?void 0:n._id).then((function(){P(!E),x([]),k(1),C(0),document.activeElement.blur()}))}))},children:"Clear"})}),Object(d.jsx)("div",{className:"w-full p-1 pb-4 overflow-x-auto",children:Object(d.jsx)(a.K,{pagination:{totalCount:_,page:g,onPageChange:k,withText:!0,itemsPerPage:10,maxVisiblePages:1},data:O.map((function(e,t){return Object(r.a)(Object(r.a)({},e),{},{id:e.epoch+t})})),Header:R,Tr:I,itemsPerPage:10,Empty:function(){return Object(d.jsx)("div",{className:"mx-5 mt-4 flex flex-col items-center",children:Object(d.jsx)("h3",{className:"text-md font-semibold text-gray-300 leading-loose",children:"No saved data"})})}})})]})},m=n(63),b=function(e){var t,n=e.data;return Object(d.jsx)("div",{className:" flex flex-row justify-around flex-wrap",children:null===n||void 0===n||null===(t=n.parameters)||void 0===t?void 0:t.map((function(e,t){return Object(d.jsx)(m.b,{title:e.name||e.label,value:String(e.value*e.factor),unit:e.unit,info:e.description,className:"w-full sm:w-1/2  md:w-1/4 lg:w-1/5 flex"},t)}))})},j=function(e){var t,n,r=e.device,c=e.isConnected,o=e.goBack,i=e.onOpenModel;return Object(d.jsxs)("div",{className:"my-2 p-2 flex flex-row items-start rounded-md bg-white shadow ",children:[Object(d.jsx)(a.F,{className:"my-3 mr-2 h-6 w-6 text-neutral-300 cursor-pointer",onClick:o}),Object(d.jsxs)("div",{className:"w-full my-2 flex flex-col",children:[Object(d.jsxs)("div",{className:"flex flex-row items-center",children:[Object(d.jsx)("h1",{className:"mr-4 text-lg font-semibold truncate text-primary-800",children:null===r||void 0===r?void 0:r.name}),Object(d.jsx)(a.a,{dot:!0,rounded:!0,label:c?"Active":"Inactive",size:a.b.SMALL,color:c?"success":"neutral",className:"w-min h-min"})]}),Object(d.jsxs)("div",{className:"flex flex-row flex-wrap justify-between items-end",children:[Object(d.jsxs)("div",{className:"flex flex-col",children:[Object(d.jsxs)("h3",{className:"mt-2 text-xs font-italic text-neutral-600 font-base truncate",children:[Object(d.jsx)("span",{className:"font-semibold",children:"Kind: "}),"".concat(null===r||void 0===r||null===(t=r.kind)||void 0===t?void 0:t.name," (").concat(null===r||void 0===r||null===(n=r.kind)||void 0===n?void 0:n.kind,")")]}),Object(d.jsxs)("h3",{className:"mt-2 text-xs font-italic text-neutral-600 font-base truncate",children:[Object(d.jsx)("span",{className:"font-semibold",children:"URL: "}),"".concat(null===r||void 0===r?void 0:r.protocol,"://").concat(null===r||void 0===r?void 0:r.url,":").concat(null===r||void 0===r?void 0:r.port)]}),Object(d.jsxs)("h3",{className:"mt-2 text-xs font-italic text-neutral-600 font-base truncate",children:[Object(d.jsx)("span",{className:"font-semibold",children:"Topic: "}),"".concat(null===r||void 0===r?void 0:r.topic)]})]}),Object(d.jsx)("div",{className:"flex flex-row mt-2 ",children:Object(d.jsx)(a.c,{size:"small",variant:"white",className:"mr-2 ",onClick:function(){return i(!0)},children:Object(d.jsx)(a.I,{className:"text-gray-700"})})})]})]})]})},v=n(151),p=n(129),O=["General","Data"].map((function(e){return{value:e,label:e}}));t.default=function(e){var t,n=e.match,u=e.history,l=Object(o.useState)(),m=Object(c.a)(l,2),x=m[0],h=m[1],w=Object(o.useState)(O[0]),g=Object(c.a)(w,2),k=g[0],N=g[1],y=Object(o.useState)({}),_=Object(c.a)(y,2),C=_[0],q=_[1],A=Object(o.useState)(!1),E=Object(c.a)(A,2),P=E[0],S=E[1],D=Object(o.useState)(!1),R=Object(c.a)(D,2),I=R[0],T=R[1],U=Object(o.useState)(!1),B=Object(c.a)(U,2),F=B[0],L=B[1],M="".concat(n.params.id);Object(o.useEffect)((function(){M&&(console.log("getDevice"),Object(s.f)(M).then(h).catch(console.log))}),[]);var V=Object(o.useCallback)(Object(i.throttle)((function(e){var t,n=Object(s.n)(null===(t=x.kind)||void 0===t?void 0:t.kind,null===e||void 0===e?void 0:e.parameters);q(Object(r.a)(Object(r.a)({},e),{},{parameters:n}))}),1e3,{trailing:!0}),[null===x||void 0===x||null===(t=x.kind)||void 0===t?void 0:t.kind]);Object(o.useEffect)((function(){return(null===x||void 0===x?void 0:x._id)&&Object(s.i)(null===x||void 0===x?void 0:x._id).then((function(e){e.length>0&&V(e[0])})),function(){return(null===x||void 0===x?void 0:x._id)&&Object(s.c)(null===x||void 0===x?void 0:x._id)}}),[null===x||void 0===x?void 0:x._id,V]),Object(o.useEffect)((function(){var e;return(null===x||void 0===x?void 0:x._id)&&Object(p.b)(x).then((function(t){e=null===t||void 0===t?void 0:t.subscribe((function(e){!I&&T(!0),V(e)}),(function(e){console.log(e),I&&T(!1)}))})).catch((function(e){console.log(e),I&&T(!1)})),function(){e&&e((function(){console.log("unsubscribe")}))}}),[null===x||void 0===x?void 0:x._id,I,F]);return Object(d.jsxs)("div",{className:"mx-4 pb-4",children:[Object(d.jsx)(j,{device:x,isConnected:!0,goBack:function(){return u.goBack()},onOpenModel:S}),Object(d.jsx)(a.h,{onSelect:N,selected:k,options:O}),Object(d.jsx)("div",{className:"p-3 mt-4 sm:m-0 flex flex-col items-center rounded-md sm:rounded-t-none bg-white shadow ",children:function(e){switch(e.value){case"General":return Object(d.jsx)(b,{data:C,device:x});case"Data":return Object(d.jsx)(f,{device:x});default:return Object(d.jsx)("div",{})}}(k)}),Object(d.jsx)(v.a,{isOpen:P,initialValues:x,onClose:function(){return S(!1)},onUpdate:function(e){return Object(s.p)(e).then((function(){h(e),L(!F)}))}})]})}}}]);
//# sourceMappingURL=8.59371727.chunk.js.map