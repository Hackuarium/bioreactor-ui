(this["webpackJsonpbioreactor-ui"]=this["webpackJsonpbioreactor-ui"]||[]).push([[12],{393:function(e,t,n){"use strict";n.r(t);var c,a=n(3),r=n(1),i=n(53),l=n.n(i),s=n(59),o=n(6),u=n(2),d=n(147),f=n(63),v=n(0),j=function(e){var t,n=e.data;return Object(v.jsxs)("div",{className:"flex flex-col",children:[(null===n||void 0===n?void 0:n.epoch)&&Object(v.jsxs)("p",{className:"mx-2 my-2 text-base font-medium text-black self-end",children:["Awake time:",Object(v.jsx)("span",{className:"mx-1 text-sm text-neutral-500",children:(null===n||void 0===n?void 0:n.epoch)/1e3+"s"})]}),Object(v.jsx)("div",{className:" flex flex-row justify-around flex-wrap",children:null===n||void 0===n||null===(t=n.parametersArray)||void 0===t?void 0:t.map((function(e,t){return Object(v.jsx)(f.b,{title:e.name||e.label,value:e.value*e.factor,unit:e.unit,info:e.description,className:"w-full sm:w-1/2  md:w-1/4 lg:w-1/5 flex"},t)}))})]})},b=n(28),m=n(20),x=n(108),p=n(137),O=function(e){var t=e.device,n=e.refreshInterval,c=Object(u.useState)([]),a=Object(o.a)(c,2),i=a[0],l=a[1],s=Object(u.useState)([]),d=Object(o.a)(s,2),f=d[0],j=d[1];Object(u.useEffect)((function(){(null===t||void 0===t?void 0:t._id)&&Object(x.j)(null===t||void 0===t?void 0:t._id).then((function(e){O(e),j(e)}))}),[null===t||void 0===t?void 0:t._id]),Object(u.useEffect)((function(){if((null===t||void 0===t?void 0:t._id)&&(null===t||void 0===t?void 0:t.connected)){var e=setInterval((function(){return Object(x.j)(null===t||void 0===t?void 0:t._id).then((function(e){O(e),j(e)}))}),n);return function(){return clearInterval(e)}}}),[null===t||void 0===t?void 0:t._id,null===t||void 0===t?void 0:t.connected,n]);var O=function(e){if(0===i.length&&e&&e.length>0){var t,n=null===(t=e[0].parametersArray)||void 0===t?void 0:t.map((function(e){return e.name||e.label}));l(["Time"].concat(Object(b.a)(n)))}},h=Object(u.useCallback)((function(e){var t,n="text-xs text-center p-2";return Object(v.jsxs)("tr",{children:[Object(v.jsx)(m.L,{compact:!0,className:n+" font-medium",children:Object(p.b)(e.value.epoch)}),null===(t=e.value.parametersArray)||void 0===t?void 0:t.map((function(e,t){return Object(v.jsx)(m.L,{compact:!0,className:n,children:e.value},t)}))]})}),[]),w=Object(u.useCallback)((function(){return Object(v.jsx)("tr",{children:null===i||void 0===i?void 0:i.map((function(e){return Object(v.jsx)(m.M,{className:"p-2 text-center font-normal normal-case",compact:!0,children:e},e)}))})}),[i]),y=Object(m.Q)(f,{itemsPerPage:10,withText:!0}),k=y.pagination,g=y.data;return Object(v.jsxs)("div",{className:"w-full",children:[Object(v.jsx)("div",{className:"w-full p-2 flex flex-row justify-end",children:Object(v.jsx)(m.c,{size:"small",variant:"white",onClick:function(){Object(x.b)(null===t||void 0===t?void 0:t._id).then((function(){return j([])}))},children:"Clear"})}),Object(v.jsx)("div",{className:"w-full p-1 pb-4 overflow-x-auto",children:Object(v.jsx)(m.K,{pagination:k,data:g.map((function(e,t){return Object(r.a)(Object(r.a)({},e),{},{id:e.epoch+t})})),Header:w,Tr:h})})]})},h=n(122),w=n(138),y=n(104),k=[1,2,5,10,30,60,120,300].map((function(e){return{label:e>59?"".concat(e/60," m"):"".concat(e," s"),value:1e3*e,type:"option"}})),g=function(e){var t=e.device,n=e.refreshInterval,c=e.setRefreshInterval,a=e.data,i=e.refreshData,d=Object(u.useState)([]),j=Object(o.a)(d,2),b=j[0],x=j[1],p=Object(u.useState)({label:n/1e3+" s",value:n,type:"option"}),O=Object(o.a)(p,2),g=O[0],N=O[1],S=Object(h.a)(),E=S.addInfoNotification,C=S.addErrorNotification;Object(u.useEffect)((function(){var e=null===a||void 0===a?void 0:a.parameters,t=e&&Object.keys(e).filter((function(t){return e[t].writable})).map((function(t){return Object(r.a)(Object(r.a)({},e[t]),{},{key:t})}));x(t)}),[a]);var I=function(){var e=Object(s.a)(l.a.mark((function e(n,c){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log(n+" is set to: "+c),e.next=4,Object(w.e)(t.id,y.a.setParameter(n,c));case 4:i(),E("saved","",1e3),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),C(e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}(),z=function(){var e=Object(s.a)(l.a.mark((function e(){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(w.e)(t.id,y.a.reset);case 3:n=e.sent,E(n),i(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),C(e.t0.message);case 11:document.activeElement.blur();case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),A=function(){var e=Object(s.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(w.e)(t.id,y.a.sleep);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),C(e.t0.message);case 8:document.activeElement.blur();case 9:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}();return Object(v.jsxs)("div",{className:"w-full flex flex-col ",children:[Object(v.jsxs)("div",{className:"mt-2 flex flex-col sm:flex-row justify-between",children:[Object(v.jsxs)("div",{className:"my-1 mx-2 flex flex-row items-center justify-end",children:[Object(v.jsx)("p",{className:"mx-1 text-sm font-medium text-neutral-700",children:"Refresh interval :"}),Object(v.jsx)(m.e,{title:g.label,options:[k],onSelect:function(e){N(e),c(e.value),document.activeElement.blur()}})]}),Object(v.jsxs)("div",{className:"my-1 flex flex-row justify-end",children:[Object(v.jsx)(m.c,{className:"mx-2",variant:"white",onClick:A,children:"Sleep"}),Object(v.jsx)(m.c,{className:"mx-2 ",variant:"white",onClick:z,children:"Reset Device"})]})]}),(null===b||void 0===b?void 0:b.length)>0&&Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(f.c,{title:"Edit parameters"}),Object(v.jsx)("div",{className:"flex flex-row justify-start flex-wrap",children:b.map((function(e,t){return Object(v.jsx)(f.a,{id:e.key,title:e.name||e.label,initialValue:e.value*e.factor,placeholder:e.name,unit:e.unit,info:e.description,onSave:I,className:"w-full sm:w-1/2  md:w-1/4 lg:w-1/5 flex"},t)}))})]})]})},N=["title","titleId"];function S(){return(S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var c in n)Object.prototype.hasOwnProperty.call(n,c)&&(e[c]=n[c])}return e}).apply(this,arguments)}function E(e,t){if(null==e)return{};var n,c,a=function(e,t){if(null==e)return{};var n,c,a={},r=Object.keys(e);for(c=0;c<r.length;c++)n=r[c],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(c=0;c<r.length;c++)n=r[c],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function C(e,t){var n=e.title,a=e.titleId,r=E(e,N);return u.createElement("svg",S({viewBox:"0 0 20 20",ref:t,"aria-labelledby":a},r),n?u.createElement("title",{id:a},n):null,c||(c=u.createElement("path",{d:"M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"})))}var I=u.forwardRef(C),z=(n.p,function(e){var t=e.device,n=Object(u.useState)(),c=Object(o.a)(n,2),a=c[0],r=c[1],i=Object(u.useState)(""),d=Object(o.a)(i,2),f=d[0],j=d[1],b=Object(u.useState)(""),x=Object(o.a)(b,2),p=x[0],O=x[1],k=Object(h.a)().addErrorNotification;Object(u.useEffect)((function(){r(null===t||void 0===t?void 0:t.id),g()}),[null===t||void 0===t?void 0:t.id]);var g=function(){var e=Object(s.a)(l.a.mark((function e(){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===t||void 0===t?void 0:t.id)||!(null===t||void 0===t?void 0:t.connected)){e.next=6;break}return j(y.a.help),e.next=4,Object(w.e)(null===t||void 0===t?void 0:t.id,y.a.help);case 4:n=e.sent,O(n);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),N=function(){var e=Object(s.a)(l.a.mark((function e(){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!f){e.next=11;break}return e.prev=1,e.next=4,Object(w.e)(a,f);case 4:n=e.sent,O(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),k(e.t0.name,(null===t||void 0===t?void 0:t.connected)?e.t0.message:"".concat(null===t||void 0===t?void 0:t.name," is disconnected"));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=Object(s.a)(l.a.mark((function e(){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,j(y.a.help),e.next=4,Object(w.e)(a,y.a.help);case 4:n=e.sent,O(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),k(e.t0.name,(null===t||void 0===t?void 0:t.connected)?e.t0.message:"".concat(null===t||void 0===t?void 0:t.name," is disconnected"));case 11:setTimeout((function(){return document.activeElement.blur()}),100);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),E=function(){var e=Object(s.a)(l.a.mark((function e(){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,j(y.a.settings),e.next=4,Object(w.e)(a,y.a.settings);case 4:n=e.sent,O(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),k(e.t0.name,(null===t||void 0===t?void 0:t.connected)?e.t0.message:"".concat(null===t||void 0===t?void 0:t.name," is disconnected"));case 11:setTimeout((function(){return document.activeElement.blur()}),100);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return Object(v.jsx)("div",{className:"w-full   ",children:Object(v.jsxs)("div",{className:"flex flex-col",children:[Object(v.jsxs)("div",{className:"w-full my-1 md:max-w-md flex flex-row",children:[Object(v.jsx)("input",{className:"w-full py-1 px-2 border rounded-md text-base",placeholder:"h (for help)",style:{fontFamily:"monospace"},value:f,onChange:function(e){return j(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&N()}}),Object(v.jsx)(m.c,{className:"mx-2 md:mr-0",variant:"primary",size:"small",onClick:N,children:"Send"}),Object(v.jsx)("div",{className:"flex ml-4 self-center md:hidden",children:Object(v.jsx)(m.e,{options:[[{label:"Help",type:"option"},{label:"Settings",type:"option"}]],onSelect:function(e){return"Help"===e.label?S():"Settings"===e.label?E():null},children:Object(v.jsx)(I,{className:"w-5 h-5",fill:"currentColor"})})})]}),Object(v.jsxs)("div",{className:"w-full mt-2 flex flex-col md:flex-row md:max-w-2xl",children:[Object(v.jsx)("div",{className:"w-full h-96 md:mr-2 flex md:flex-1 border rounded-md overflow-auto overflow-x-auto",children:Object(v.jsx)("textarea",{className:"w-full text-sm font-semibold text-success-400 bg-neutral-900",style:{fontFamily:"monospace"},value:p,onChange:function(e){return console.log(e.target.value)},disabled:!0})}),Object(v.jsxs)("div",{className:"hidden flex-col md:flex",children:[Object(v.jsx)(m.c,{className:"m-1",variant:"white",size:"xSmall",onClick:S,children:"Help"}),Object(v.jsx)(m.c,{className:"m-1",variant:"white",size:"xSmall",onClick:E,children:"Settings"})]})]})]})})}),A=function(e){var t,n,c=e.device,a=e.goBack,r=e.onOpenModel,i=e.onRequest;return Object(v.jsxs)("div",{className:"my-4 py-3 px-4 flex flex-col rounded-md bg-white shadow ",children:[Object(v.jsx)("p",{className:"text-xs font-semibold underline text-primary-500 cursor-pointer",onClick:a,children:"<< Back to devices list"}),Object(v.jsxs)("div",{className:"mt-4 flex flex-col",children:[Object(v.jsxs)("div",{className:"flex flex-row items-center",children:[Object(v.jsx)("h1",{className:"mr-4 text-lg font-semibold truncate text-primary-800",children:null===c||void 0===c?void 0:c.name}),Object(v.jsx)(m.a,{dot:!0,rounded:!0,label:(null===c||void 0===c?void 0:c.connected)?"Active":"Inactive",size:m.b.SMALL,color:(null===c||void 0===c?void 0:c.connected)?"success":"neutral",className:"w-min h-min"})]}),Object(v.jsxs)("div",{className:"flex flex-row flex-wrap justify-between items-center",children:[Object(v.jsx)("h3",{className:"mt-2 text-xs font-italic text-neutral-600 font-semibold truncate",children:"".concat(null===c||void 0===c||null===(t=c.kind)||void 0===t?void 0:t.name," (").concat(null===c||void 0===c||null===(n=c.kind)||void 0===n?void 0:n.kind,")")}),Object(v.jsxs)("div",{className:"flex flex-row mt-2 ",children:[Object(v.jsx)(m.c,{size:"small",variant:"white",className:"mr-2 ",onClick:function(){return r(!0)},children:Object(v.jsx)(m.I,{className:"text-gray-700"})}),!(null===c||void 0===c?void 0:c.connected)&&Object(v.jsx)(m.c,{size:"xSmall",onClick:i,children:"Request"})]})]})]})]})},_=n(211),R=["connected"],M=["General","History","Advanced","Configuration"].map((function(e){return{value:e,label:e}}));t.default=function(e){var t=e.match,n=e.history,c=Object(u.useState)(),i=Object(o.a)(c,2),f=i[0],b=i[1],p=Object(u.useState)(M[0]),k=Object(o.a)(p,2),N=k[0],S=k[1],E=Object(u.useState)(!1),C=Object(o.a)(E,2),I=C[0],H=C[1],P=Object(u.useState)(!1),B=Object(o.a)(P,2),T=B[0],D=B[1],L=Object(u.useState)({}),q=Object(o.a)(L,2),F=q[0],G=q[1],J=Object(u.useState)(2e3),K=Object(o.a)(J,2),V=K[0],Q=K[1],W=Object(h.a)().addWarningNotification;Object(u.useEffect)((function(){var e="".concat(t.params.id);Object(x.f)(e).then((function(e){b(e)}))}),[t.params.id]);var U=Object(u.useCallback)(Object(s.a)(l.a.mark((function e(){var t,n,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===f||void 0===f?void 0:f.id)){e.next=16;break}if(!(null===f||void 0===f?void 0:f.connected)){e.next=15;break}return e.prev=2,e.next=5,Object(w.e)(null===f||void 0===f?void 0:f.id,y.a.compactSettings);case 5:n=e.sent,c=Object(d.parseCurrentSettings)(n,{kind:null===f||void 0===f||null===(t=f.kind)||void 0===t?void 0:t.kind,parameterInfo:!0,parametersArray:!0}),G(c),Object(x.o)(f._id,c),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(2);case 13:e.next=16;break;case 15:Object(x.i)(f._id).then((function(e){console.log(e),e.length>0&&G(e[0])}));case 16:case"end":return e.stop()}}),e,null,[[2,11]])}))),[null===f||void 0===f?void 0:f.id,null===f||void 0===f?void 0:f.connected]);Object(u.useEffect)((function(){U()}),[U]),Object(u.useEffect)((function(){if((null===f||void 0===f?void 0:f.id)&&(null===f||void 0===f?void 0:f.connected)){var e=setInterval((function(){return U()}),V);return function(){return clearInterval(e)}}}),[U,V]),Object(u.useEffect)((function(){X();var e=Object(w.a)((function(e){var t=e.filter((function(e){return e.id===(null===f||void 0===f?void 0:f.id)})).length>0;t&&!(null===f||void 0===f?void 0:f.connected)?b(Object(r.a)(Object(r.a)({},f),{},{connected:!0})):!t&&(null===f||void 0===f?void 0:f.connected)&&(W("".concat(null===f||void 0===f?void 0:f.name," is disconnected")),b(Object(r.a)(Object(r.a)({},f),{},{connected:!1})))}),1e3);return function(){return e.then((function(e){return clearInterval(e)}))}}),[null===f||void 0===f?void 0:f.id,null===f||void 0===f?void 0:f.connected,T]);var X=function(){var e=Object(s.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(w.b)();case 2:e.sent.filter((function(e){return e.id===(null===f||void 0===f?void 0:f.id)})).length>0&&b(Object(r.a)(Object(r.a)({},f),{},{connected:!0}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Y=function(){var e=Object(s.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.activeElement.blur(),e.next=3,Object(w.d)();case 3:X();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Z=function(){var e=Object(s.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.connected,n=Object(a.a)(t,R),Object(x.p)(n).then((function(){b(t),D(!T),H(!1)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(v.jsxs)("div",{className:"mx-4 pb-4",children:[Object(v.jsx)(A,{device:f,goBack:function(){return n.goBack()},onOpenModel:H,onRequest:Y}),Object(v.jsx)(m.h,{onSelect:S,selected:N,options:M}),Object(v.jsx)("div",{className:"p-3 mt-4 sm:m-0 flex flex-col items-center rounded-md sm:rounded-t-none bg-white shadow ",children:function(e){switch(e.value){case"General":return Object(v.jsx)(j,{data:F});case"History":return Object(v.jsx)(O,{device:f,refreshInterval:V});case"Advanced":return Object(v.jsx)(z,{device:f});case"Configuration":return Object(v.jsx)(g,{device:f,refreshInterval:V,setRefreshInterval:Q,data:F,refreshData:function(){return U()}});default:return Object(v.jsx)("div",{})}}(N)}),Object(v.jsx)(_.a,{isOpen:I,onClose:function(){return H(!1)},initialValues:f,onSave:Z})]})}}}]);
//# sourceMappingURL=12.a6af4e6c.chunk.js.map