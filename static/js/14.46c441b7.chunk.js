(this["webpackJsonpbioreactor-ui"]=this["webpackJsonpbioreactor-ui"]||[]).push([[14],{404:function(e,t,n){"use strict";n.r(t);var c,a=n(3),r=n(1),i=n(53),l=n.n(i),s=n(59),o=n(6),u=n(2),d=n(149),f=n(20),v=n(117),j=n(123),b=n(106),m=n(116),x=n(63),p=n(0),O=function(e){var t,n=e.data,c=e.device,a=Object(v.a)(),r=a.addInfoNotification,i=a.addErrorNotification,o=function(){var e=Object(s.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(j.i)(c.id,t);case 3:n=e.sent,console.log("runExperiment"),console.log(n),r(n),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("runExperiment error"),console.log(e.t0),i(e.t0);case 14:document.activeElement.blur();case 15:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsxs)("div",{className:"flex flex-col mt-2",children:[Object(p.jsxs)("div",{className:"flex flex-row justify-end",children:[Object(p.jsx)(f.c,{className:"mx-2",onClick:function(){return o(b.a.runExperiment)},children:"Run experiment"}),Object(p.jsx)(f.c,{className:"mx-2",onClick:function(){return o(b.a.kinetic)},children:"Run Kinetic"})]}),(null===n||void 0===n?void 0:n.epoch)&&Object(p.jsx)(x.c,{title:Object(p.jsxs)("p",{className:" text-base font-medium text-black self-start",children:["Awake time:",Object(p.jsx)("span",{className:"mx-1 text-sm text-neutral-500",children:(null===n||void 0===n?void 0:n.epoch)/1e3+"s"})]})}),Object(p.jsx)("div",{className:" flex flex-row justify-around flex-wrap",children:null===n||void 0===n||null===(t=n.parametersArray)||void 0===t?void 0:t.map((function(e,t){return Object(p.jsx)(x.b,{title:e.name||e.label,value:e.value*e.factor,unit:e.unit,info:e.description,className:"w-full sm:w-1/2  md:w-1/4 lg:w-1/5 flex"},t)}))})]})},h=n(28),w=function(e){var t=e.device,n=e.refreshInterval,c=Object(u.useState)([]),a=Object(o.a)(c,2),i=a[0],l=a[1],s=Object(u.useState)([]),d=Object(o.a)(s,2),v=d[0],b=d[1];Object(u.useEffect)((function(){(null===t||void 0===t?void 0:t._id)&&Object(j.e)(null===t||void 0===t?void 0:t._id).then((function(e){m(e),b(e)}))}),[null===t||void 0===t?void 0:t._id]),Object(u.useEffect)((function(){if((null===t||void 0===t?void 0:t._id)&&(null===t||void 0===t?void 0:t.connected)){var e=setInterval((function(){return Object(j.e)(null===t||void 0===t?void 0:t._id).then((function(e){m(e),b(e)}))}),n);return function(){return clearInterval(e)}}}),[null===t||void 0===t?void 0:t._id,null===t||void 0===t?void 0:t.connected,n]);var m=function(e){if(0===i.length&&e&&e.length>0){var t,n=null===(t=e[0].parametersArray)||void 0===t?void 0:t.map((function(e){return e.name||e.label}));l(["Epoch"].concat(Object(h.a)(n)))}},x=Object(u.useCallback)((function(e){var t,n="text-xs text-center p-2";return Object(p.jsxs)("tr",{children:[Object(p.jsx)(f.K,{compact:!0,className:n+" font-medium",children:e.value.epoch}),null===(t=e.value.parametersArray)||void 0===t?void 0:t.map((function(e,t){return Object(p.jsx)(f.K,{compact:!0,className:n,children:e.value},t)}))]})}),[]),O=Object(u.useCallback)((function(){return Object(p.jsx)("tr",{children:null===i||void 0===i?void 0:i.map((function(e){return Object(p.jsx)(f.L,{className:"p-2 text-center font-normal normal-case",compact:!0,children:e},e)}))})}),[i]),w=Object(f.P)(v,{itemsPerPage:10,withText:!0}),y=w.pagination,k=w.data;return Object(p.jsxs)("div",{className:"w-full",children:[Object(p.jsx)("div",{className:"w-full p-2 flex flex-row justify-end",children:Object(p.jsx)(f.c,{size:"small",variant:"white",onClick:function(){Object(j.a)(null===t||void 0===t?void 0:t._id).then((function(){return b([])}))},children:"Clear"})}),Object(p.jsx)("div",{className:"w-full p-1 pb-4 overflow-x-auto",children:Object(p.jsx)(f.J,{pagination:y,data:k.map((function(e,t){return Object(r.a)(Object(r.a)({},e),{},{id:e.epoch+t})})),Header:O,Tr:x})})]})},y=[1,2,5,10,30,60,120,300].map((function(e){return{label:e>59?"".concat(e/60," m"):"".concat(e," s"),value:1e3*e,type:"option"}})),k=function(e){var t=e.device,n=e.refreshInterval,c=e.setRefreshInterval,a=e.data,i=e.refreshData,d=Object(u.useState)([]),m=Object(o.a)(d,2),O=m[0],h=m[1],w=Object(u.useState)({label:n/1e3+" s",value:n,type:"option"}),k=Object(o.a)(w,2),N=k[0],g=k[1],S=Object(v.a)(),E=S.addInfoNotification,C=S.addErrorNotification;Object(u.useEffect)((function(){var e=null===a||void 0===a?void 0:a.parameters,t=e&&Object.keys(e).filter((function(t){return e[t].writable})).map((function(t){return Object(r.a)(Object(r.a)({},e[t]),{},{key:t})}));h(t)}),[a]);var I=function(){var e=Object(s.a)(l.a.mark((function e(n,c){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log(n+" is set to: "+c),e.next=4,Object(j.i)(t.id,b.a.setParameter(n,c));case 4:i(),E("saved","",1e3),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),C(e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}(),z=function(){var e=Object(s.a)(l.a.mark((function e(){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(j.i)(t.id,b.a.reset);case 3:n=e.sent,E(n),i(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),C(e.t0.message);case 11:document.activeElement.blur();case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),A=function(){var e=Object(s.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(j.i)(t.id,b.a.sleep);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),C(e.t0.message);case 8:document.activeElement.blur();case 9:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}();return Object(p.jsxs)("div",{className:"w-full flex flex-col ",children:[Object(p.jsxs)("div",{className:"mt-2 flex flex-col sm:flex-row justify-between",children:[Object(p.jsxs)("div",{className:"my-1 mx-2 flex flex-row items-center justify-end",children:[Object(p.jsx)("p",{className:"mx-1 text-sm font-medium text-neutral-700",children:"Refresh interval :"}),Object(p.jsx)(f.e,{title:N.label,options:[y],onSelect:function(e){g(e),c(e.value),document.activeElement.blur()}})]}),Object(p.jsxs)("div",{className:"my-1 flex flex-row justify-end",children:[Object(p.jsx)(f.c,{className:"mx-2",variant:"white",onClick:A,children:"Sleep"}),Object(p.jsx)(f.c,{className:"mx-2 ",variant:"white",onClick:z,children:"Reset Device"})]})]}),(null===O||void 0===O?void 0:O.length)>0&&Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(x.c,{title:"Edit parameters"}),Object(p.jsx)("div",{className:"flex flex-row justify-start flex-wrap",children:O.map((function(e,t){return Object(p.jsx)(x.a,{id:e.key,title:e.name||e.label,initialValue:e.value*e.factor,placeholder:e.name,unit:e.unit,info:e.description,onSave:I,className:"w-full sm:w-1/2  md:w-1/4 lg:w-1/5 flex"},t)}))})]})]})},N=["title","titleId"];function g(){return(g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var c in n)Object.prototype.hasOwnProperty.call(n,c)&&(e[c]=n[c])}return e}).apply(this,arguments)}function S(e,t){if(null==e)return{};var n,c,a=function(e,t){if(null==e)return{};var n,c,a={},r=Object.keys(e);for(c=0;c<r.length;c++)n=r[c],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(c=0;c<r.length;c++)n=r[c],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function E(e,t){var n=e.title,a=e.titleId,r=S(e,N);return u.createElement("svg",g({viewBox:"0 0 20 20",ref:t,"aria-labelledby":a},r),n?u.createElement("title",{id:a},n):null,c||(c=u.createElement("path",{d:"M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"})))}var C=u.forwardRef(E),I=(n.p,function(e){var t=e.device,n=Object(u.useState)(),c=Object(o.a)(n,2),a=c[0],r=c[1],i=Object(u.useState)(""),d=Object(o.a)(i,2),m=d[0],x=d[1],O=Object(u.useState)(""),h=Object(o.a)(O,2),w=h[0],y=h[1],k=Object(v.a)().addErrorNotification;Object(u.useEffect)((function(){r(null===t||void 0===t?void 0:t.id),N()}),[null===t||void 0===t?void 0:t.id]);var N=function(){var e=Object(s.a)(l.a.mark((function e(){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===t||void 0===t?void 0:t.id)||!(null===t||void 0===t?void 0:t.connected)){e.next=6;break}return x(b.a.help),e.next=4,Object(j.i)(null===t||void 0===t?void 0:t.id,b.a.help);case 4:n=e.sent,y(n);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=function(){var e=Object(s.a)(l.a.mark((function e(){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!m){e.next=11;break}return e.prev=1,e.next=4,Object(j.i)(a,m);case 4:n=e.sent,y(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),k(e.t0.name,(null===t||void 0===t?void 0:t.connected)?e.t0.message:"".concat(null===t||void 0===t?void 0:t.name," is disconnected"));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=Object(s.a)(l.a.mark((function e(){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,x(b.a.help),e.next=4,Object(j.i)(a,b.a.help);case 4:n=e.sent,y(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),k(e.t0.name,(null===t||void 0===t?void 0:t.connected)?e.t0.message:"".concat(null===t||void 0===t?void 0:t.name," is disconnected"));case 11:setTimeout((function(){return document.activeElement.blur()}),100);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),E=function(){var e=Object(s.a)(l.a.mark((function e(){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,x(b.a.settings),e.next=4,Object(j.i)(a,b.a.settings);case 4:n=e.sent,y(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),k(e.t0.name,(null===t||void 0===t?void 0:t.connected)?e.t0.message:"".concat(null===t||void 0===t?void 0:t.name," is disconnected"));case 11:setTimeout((function(){return document.activeElement.blur()}),100);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return Object(p.jsx)("div",{className:"w-full   ",children:Object(p.jsxs)("div",{className:"flex flex-col",children:[Object(p.jsxs)("div",{className:"w-full my-1 md:max-w-md flex flex-row",children:[Object(p.jsx)("input",{className:"w-full py-1 px-2 border rounded-md text-base",placeholder:"h (for help)",style:{fontFamily:"monospace"},value:m,onChange:function(e){return x(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&g()}}),Object(p.jsx)(f.c,{className:"mx-2 md:mr-0",variant:"primary",size:"small",onClick:g,children:"Send"}),Object(p.jsx)("div",{className:"flex ml-4 self-center md:hidden",children:Object(p.jsx)(f.e,{options:[[{label:"Help",type:"option"},{label:"Settings",type:"option"}]],onSelect:function(e){return"Help"===e.label?S():"Settings"===e.label?E():null},children:Object(p.jsx)(C,{className:"w-5 h-5",fill:"currentColor"})})})]}),Object(p.jsxs)("div",{className:"w-full mt-2 flex flex-col md:flex-row md:max-w-2xl",children:[Object(p.jsx)("div",{className:"w-full h-96 md:mr-2 flex md:flex-1 border rounded-md overflow-auto overflow-x-auto",children:Object(p.jsx)("textarea",{className:"w-full text-sm font-semibold text-success-400 bg-neutral-900",style:{fontFamily:"monospace"},value:w,onChange:function(e){return console.log(e.target.value)},disabled:!0})}),Object(p.jsxs)("div",{className:"hidden flex-col md:flex",children:[Object(p.jsx)(f.c,{className:"m-1",variant:"white",size:"xSmall",onClick:S,children:"Help"}),Object(p.jsx)(f.c,{className:"m-1",variant:"white",size:"xSmall",onClick:E,children:"Settings"})]})]})]})})}),z=n(210),A=["connected"],_=["General","History","Advanced","Configuration"].map((function(e){return{value:e,label:e}}));t.default=function(e){var t,n,c=e.match,i=e.history,x=Object(u.useState)(),h=Object(o.a)(x,2),y=h[0],N=h[1],g=Object(u.useState)(_[0]),S=Object(o.a)(g,2),E=S[0],C=S[1],R=Object(u.useState)(!1),H=Object(o.a)(R,2),P=H[0],D=H[1],K=Object(u.useState)({}),M=Object(o.a)(K,2),T=M[0],B=M[1],F=Object(u.useState)(2e3),J=Object(o.a)(F,2),L=J[0],G=J[1],V=Object(v.a)().addWarningNotification;Object(u.useEffect)((function(){var e="".concat(c.params.id);Object(m.e)(e).then((function(e){N(e)}))}),[c.params.id]);var q=Object(u.useCallback)(Object(s.a)(l.a.mark((function e(){var t,n,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===y||void 0===y?void 0:y.id)){e.next=16;break}if(!(null===y||void 0===y?void 0:y.connected)){e.next=15;break}return e.prev=2,e.next=5,Object(j.i)(null===y||void 0===y?void 0:y.id,b.a.compactSettings);case 5:n=e.sent,c=Object(d.parseCurrentSettings)(n,{kind:null===y||void 0===y||null===(t=y.kind)||void 0===t?void 0:t.kind,parameterInfo:!0,parametersArray:!0}),B(c),Object(j.h)(y._id,c),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(2);case 13:e.next=16;break;case 15:Object(j.d)(y._id).then((function(e){console.log(e),e.length>0&&B(e[0])}));case 16:case"end":return e.stop()}}),e,null,[[2,11]])}))),[null===y||void 0===y?void 0:y.id,null===y||void 0===y?void 0:y.connected]);Object(u.useEffect)((function(){q()}),[q]),Object(u.useEffect)((function(){if((null===y||void 0===y?void 0:y.id)&&(null===y||void 0===y?void 0:y.connected)){var e=setInterval((function(){return q()}),L);return function(){return clearInterval(e)}}}),[q,L]),Object(u.useEffect)((function(){W();var e=Object(j.b)((function(e){var t=e.filter((function(e){return e.id===(null===y||void 0===y?void 0:y.id)})).length>0;t&&!(null===y||void 0===y?void 0:y.connected)?N(Object(r.a)(Object(r.a)({},y),{},{connected:!0})):!t&&(null===y||void 0===y?void 0:y.connected)&&(V("".concat(null===y||void 0===y?void 0:y.name," is disconnected")),N(Object(r.a)(Object(r.a)({},y),{},{connected:!1})))}),1e3);return function(){return e.then((function(e){return clearInterval(e)}))}}),[null===y||void 0===y?void 0:y.id,null===y||void 0===y?void 0:y.connected]);var W=function(){var e=Object(s.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(j.c)();case 2:e.sent.filter((function(e){return e.id===(null===y||void 0===y?void 0:y.id)})).length>0&&N(Object(r.a)(Object(r.a)({},y),{},{connected:!0}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Q=function(){var e=Object(s.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.activeElement.blur(),e.next=3,Object(j.g)();case 3:W();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),U=function(){var e=Object(s.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.connected,n=Object(a.a)(t,A),Object(m.g)(n).then((function(){D(!1),N(t)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsxs)("div",{className:"mx-4 pb-4",children:[Object(p.jsxs)("div",{className:"my-4 py-3 px-4 flex flex-col rounded-md bg-white shadow ",children:[Object(p.jsx)("p",{className:"text-xs font-semibold underline text-primary-500 cursor-pointer",onClick:function(){return i.goBack()},children:"<< Back to devices list"}),Object(p.jsxs)("div",{className:"mt-4 flex flex-col",children:[Object(p.jsxs)("div",{className:"flex flex-row items-center",children:[Object(p.jsx)("h1",{className:"mr-4 text-lg font-semibold truncate text-primary-800",children:null===y||void 0===y?void 0:y.name}),Object(p.jsx)(f.a,{dot:!0,rounded:!0,label:(null===y||void 0===y?void 0:y.connected)?"Active":"Inactive",size:f.b.SMALL,color:(null===y||void 0===y?void 0:y.connected)?"success":"neutral",className:"w-min h-min"})]}),Object(p.jsxs)("div",{className:"flex flex-row flex-wrap justify-between items-center",children:[Object(p.jsx)("h3",{className:"mt-2 text-xs font-italic text-neutral-600 font-semibold truncate",children:"".concat(null===y||void 0===y||null===(t=y.kind)||void 0===t?void 0:t.name," (").concat(null===y||void 0===y||null===(n=y.kind)||void 0===n?void 0:n.kind,")")}),Object(p.jsxs)("div",{className:"flex flex-row mt-2 ",children:[Object(p.jsx)(f.c,{size:"small",variant:"white",className:"mr-2 ",onClick:function(){return D(!0)},children:Object(p.jsx)(f.H,{className:"text-gray-700"})}),!(null===y||void 0===y?void 0:y.connected)&&Object(p.jsx)(f.c,{size:"xSmall",onClick:Q,children:"Request"})]})]})]})]}),Object(p.jsx)(f.h,{onSelect:C,selected:E,options:_}),Object(p.jsx)("div",{className:"p-3 mt-4 sm:m-0 flex flex-col items-center rounded-md sm:rounded-t-none bg-white shadow ",children:function(e){switch(e.value){case"General":return Object(p.jsx)(O,{data:T,device:y});case"History":return Object(p.jsx)(w,{device:y,refreshInterval:L});case"Advanced":return Object(p.jsx)(I,{device:y});case"Configuration":return Object(p.jsx)(k,{device:y,refreshInterval:L,setRefreshInterval:G,data:T,refreshData:function(){return q()}});default:return Object(p.jsx)("div",{})}}(E)}),Object(p.jsx)(z.a,{isOpen:P,onClose:function(){return D(!1)},initialValues:y,onSave:U})]})}}}]);
//# sourceMappingURL=14.46c441b7.chunk.js.map