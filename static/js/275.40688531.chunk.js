(self.webpackChunkbioreactor_ui=self.webpackChunkbioreactor_ui||[]).push([[275],{6499:function(n,e,t){"use strict";t.d(e,{Z:function(){return u}});var r=t(8182),c=t(5749),i=t(184);function u(){var n=(0,c.JI$)(),e=function(e,t,c){var u=c.textColor,o=c.Icon,a=c.timeout;n.addNotification({title:(0,i.jsx)("span",{className:(0,r.Z)("text-base font-semibold",u+"500"),children:e}),content:(0,i.jsx)("span",{className:"text-sm text-neutral-500",children:t}),icon:(0,i.jsx)(o,{className:(0,r.Z)("w-8 h-8",u+"600")})},a)};return{addErrorNotification:function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3;e(n,t,{textColor:"text-danger-",Icon:c.mhZ,timeout:r})},addWarningNotification:function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2500;e(n,t,{textColor:"text-warning-",Icon:c.mhZ,timeout:r})},addInfoNotification:function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;e(n,t,{textColor:"text-primary-",Icon:c.aY4,timeout:r})}}}},2258:function(n,e,t){"use strict";var r=t(1413),c=(t(2791),t(1724)),i=t(5749),u=t(7104),o=t(184),a=c.Ry().shape({name:c.Z_().max(50,"Name too Long!").matches(/^[A-z0-9_-]*$/,"Field supports only : letters / numbers / _ / - ").required("Required")}),s=u.cV.map((function(n){return(0,r.Z)((0,r.Z)({},n),{},{label:n.name,value:n.kind})}));e.Z=function(n){var e,t=n.initialValues,c=n.isOpen,l=n.onClose,f=n.onSave,d={name:null===t||void 0===t?void 0:t.name,kind:null===t||void 0===t||null===(e=t.kind)||void 0===e?void 0:e.kind};return(0,o.jsxs)(i.u_l,{isOpen:c,onRequestClose:l,icon:(0,o.jsx)(i.fUM,{}),iconColor:"neutral",animated:!0,hasCloseButton:!0,requestCloseOnBackdrop:!0,requestCloseOnEsc:!0,fluid:!0,wrapperComponent:i.l09,wrapperProps:{initialValues:d,validationSchema:a,onSubmit:function(n){var e=(0,r.Z)((0,r.Z)({},t),{},{name:n.name,kind:u.cV.filter((function(e){return e.kind===n.kind}))[0]});f(e)},className:"h-full"},children:[(0,o.jsx)(i.u_l.Header,{children:"Edit device information"}),(0,o.jsxs)(i.u_l.Body,{children:[(0,o.jsxs)("div",{className:"w-full mr-32 pr-16 mt-4 mb-20 items-center",children:[(0,o.jsx)(i.mgC,{name:"kind",id:"kind",label:"Kind",options:s,renderOption:function(n){return"".concat(n.label)},getValue:function(n){return n.value},required:!0,className:"mt-4 flex-1"}),(0,o.jsx)(i.UPk,{name:"name",id:"name",label:"Name",required:!0,className:"mt-8 flex-1",inputClassName:"w-full"})]}),(0,o.jsx)(i.Xq4,{})]}),(0,o.jsx)(i.u_l.Footer,{children:(0,o.jsx)(i.Mmi,{className:"w-full sm:w-max ",children:"Save"})})]})}},8785:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return x}});var r=t(4165),c=t(5861),i=t(9439),u=t(2791),o=t(5749),a=t(7689),s=t(2258),l=t(184),f=function(n){var e=n.data,t=n.onSelect,r=n.onEdit,c=n.onDelete;return(0,l.jsx)("div",{className:"overflow-hidden bg-white shadow sm:rounded-md",children:e.map((function(n){var e;return(0,l.jsxs)("li",{className:"block transition duration-150 ease-in-out hover:bg-gray-50 focus:outline-none focus:bg-gray-50 cursor-pointer",onClick:function(e){return t(n,e)},children:[(0,l.jsxs)("div",{className:"relative flex items-center px-4 py-4 sm:px-6",children:[(0,l.jsx)("div",{className:"flex items-center flex-1 min-w-0",children:(0,l.jsxs)("div",{className:"flex-1 min-w-0 px-4 sm:grid sm:grid-col-2 sm:gap-4",children:[(0,l.jsxs)("div",{className:"col-span-2 flex flex-row items-center flex-wrap",children:[(0,l.jsx)("p",{className:"mr-4 text-lg font-semibold truncate text-primary-700 ",children:n.name}),(0,l.jsx)(o.Cts,{dot:!0,rounded:!0,label:n.connected?"Active":"Inactive",size:o.ODk.SMALL,color:n.connected?"success":"neutral",className:"w-min h-min"})]}),(0,l.jsx)("div",{className:"pt-2 sm:pt-0 flex flex-col text-xs font-italic text-neutral-600 justify-center",children:(0,l.jsx)("p",{className:"truncate",children:(0,l.jsx)("span",{className:"font-semibold",children:null===n||void 0===n||null===(e=n.kind)||void 0===e?void 0:e.name})})}),(0,l.jsxs)("div",{className:"pt-2 sm:pt-0 flex justify-end items-center cursor-default",children:[(0,l.jsx)("button",{className:"mx-1 p-2 border rounded shadow-sm bg-neutral-100 focus:outline-none active:bg-neutral-200",onClick:function(e){return r(n,e)},children:(0,l.jsx)(o.cw2,{className:"text-gray-700"})}),(0,l.jsx)("button",{className:"mx-1 p-2 border rounded shadow-sm bg-neutral-100 focus:outline-none active:bg-neutral-200",onClick:function(e){return c(n,e)},children:(0,l.jsx)(o.L9D,{className:"text-gray-700"})})]})]})}),(0,l.jsx)("div",{children:(0,l.jsx)(o.tl9,{className:"w-5 h-5 text-neutral-400"})})]}),(0,l.jsx)("div",{className:"w-full border-t border-neutral-100"})]},n.id)}))})},d=t(6499),m=t(5963),v=t(7104),p=t(8808),h=t(8433),x=function(n){var e=(0,u.useState)(!1),t=(0,i.Z)(e,2),x=t[0],w=t[1],Z=(0,u.useState)([]),g=(0,i.Z)(Z,2),b=g[0],j=g[1],N=(0,u.useState)({}),k=(0,i.Z)(N,2),y=k[0],_=k[1],C=(0,d.Z)().addInfoNotification;(0,u.useEffect)((function(){return E()}),[]);var D=(0,a.s0)();(0,u.useEffect)((function(){var n=(0,h.wc)((function(n){var e,t=n.map((function(n){return n.id})),r=b.map((function(n){return t.includes(n.id)&&!n.connected?(n.connected=!0,e=!0):!t.includes(n.id)&&n.connected&&(n.connected=!1,e=!0),n}));e&&j(r)}),1e3);return function(){return n.then((function(n){return clearInterval(n)}))}}),[b]);var E=function(){(0,p.PW)(v.me.local).then(j)},I=function(){var n=(0,c.Z)((0,r.Z)().mark((function n(){var e;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return document.activeElement.blur(),n.next=3,(0,h.nE)();case 3:return n.next=5,(0,h.JG)();case 5:e=n.sent,A(e);case 7:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),A=function(n){(0,p.PW)(v.me.local).then((function(e){var t=(0,m.e)(n,e);t.length>0&&(C("New device connected"),t.forEach((function(n){(0,p.S6)((0,h.d9)(n))})),E())}))},P=function(){var n=(0,c.Z)((0,r.Z)().mark((function n(e,t){return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t.stopPropagation(),_(e),w(!0);case 3:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}(),S=function(){var n=(0,c.Z)((0,r.Z)().mark((function n(e,t){return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t.stopPropagation(),(0,p.h1)(null===e||void 0===e?void 0:e._id),(0,p.n1)(null===e||void 0===e?void 0:e._id).then((function(){return E()}));case 3:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}(),q=function(){var n=(0,c.Z)((0,r.Z)().mark((function n(e){return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:(0,p.xl)(e).then((function(){_({}),w(!1),E()}));case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return(0,l.jsxs)("div",{className:"p-8",children:[(0,l.jsx)("h2",{className:"text-3xl font-semibold mb-10",children:"Local devices"}),(0,l.jsx)("div",{className:"w-full flex justify-end mb-4",children:(0,l.jsx)(o.zxk,{onClick:I,children:"Request Device"})}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"w-full my-2 flex flex-row items-center ",children:[(0,l.jsx)("h3",{className:"w-max ml-2 mr-4 text-neutral-600 text-sm whitespace-nowrap ",children:"Available devices"}),(0,l.jsx)("div",{className:"w-full border-t border-neutral-300"})]}),b.length>0?(0,l.jsx)(f,{data:b,onSelect:function(n,e){D("".concat(n._id))},onEdit:P,onDelete:S}):(0,l.jsxs)("div",{className:"mx-5 mt-10 flex flex-col items-center",children:[(0,l.jsx)("h3",{className:"text-sm font-bold text-gray-300 leading-loose",children:"No connected Devices"}),(0,l.jsx)("h3",{className:"text-xs font-base text-gray-300",children:"Please plug your device into the computer"})]})]}),(0,l.jsx)(s.Z,{isOpen:x,onClose:function(){w(!1),_({})},initialValues:y,onSave:q})]})}},6917:function(n,e,t){"use strict";var r=t(4165),c=t(1413),i=t(5861),u=t(1853),o={};e.Z=function(n){var e=function(){return n in o||(o[n]=new u.Z(n,{revs_limit:1,auto_compaction:!0})),o[n]},t=function(){var n=(0,i.Z)((0,r.Z)().mark((function n(t){return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,r){e().allDocs((0,c.Z)({include_docs:!0},t)).then((function(e){return n(e)})).catch((function(n){return r(n)}))})));case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return{getInfo:function(){return new Promise((function(n,t){e().info().then((function(e){return n(e)})).catch((function(n){return t(n)}))}))},getAll:t,get:function(n){return new Promise((function(t,r){var c=e();n?c.get(n).then((function(n){return t(n)})).catch((function(n){return r(n)})):r(new Error("Doc fetch : docId is required"))}))},put:function(n){return new Promise((function(t,r){var c=e();"_id"in n?c.put(n).then((function(n){return t(n)})).catch((function(n){return r(n)})):r(new Error("Doc create : _id is required in doc"))}))},update:function(n){return new Promise((function(t,r){var i=e();"_id"in n?i.get(n._id).then((function(e){return i.put((0,c.Z)((0,c.Z)({},n),{},{_rev:e._rev})).then((function(n){return t(n)})).catch((function(n){return r(n)}))})).catch((function(n){return r(n)})):r(new Error("Doc update : _id is required in doc"))}))},remove:function(n){return new Promise((function(t,r){var c=e();n?c.get(n).then((function(e){return c.remove({_id:n,_rev:e._rev}).then((function(n){return t(n)})).catch((function(n){return r(n)}))})).catch((function(n){return r(n)})):r(new Error("Doc remove : docId is required"))}))},listenToChanges:function(n,t,r){return e().changes((0,c.Z)({since:"now",live:!0,include_docs:!0},r)).on("change",n).on("error",t)},close:function(){var t=e();return delete o[n],t.close()},destroy:function(){var t=e();return delete o[n],t.destroy()}}}},7104:function(n,e,t){"use strict";t.d(e,{Bh:function(){return s},GZ:function(){return o},PH:function(){return d},QT:function(){return a},cV:function(){return m},me:function(){return f},uv:function(){return l}});var r=t(4925),c=t(3938),i=t.n(c),u=["events","parameters"],o="BIOREACTOR-UI_devices",a="https:"===window.location.protocol?"443":"80",s="https:"===window.location.protocol?"wss":"http",l=["http","tcp","wss"],f={broadcast:"broadcast",interactive:"interactive",local:"local"},d={help:"h",settings:"u",compactSettings:"uc",runExperiment:"r",kinetic:"k",reset:"ur1234",sleep:"l",setParameter:function(n,e){return"".concat(n).concat(e)}},m=Object.keys(i()).filter((function(n){return i()[n].kind})).map((function(n){var e=i()[n];e.events,e.parameters;return(0,r.Z)(e,u)}))},8808:function(n,e,t){"use strict";t.d(e,{$n:function(){return _},Aj:function(){return m},C7:function(){return Z},D4:function(){return b},Gu:function(){return N},PW:function(){return v},S6:function(){return w},_A:function(){return j},_v:function(){return p},d9:function(){return f},h1:function(){return k},n1:function(){return x},w3:function(){return g},xN:function(){return d},xl:function(){return h},xs:function(){return y}});var r=t(4165),c=t(5861),i=t(1413),u=t(3938),o=t.n(u),a=t(6917),s=t(7104),l=function(n,e){console.log(n);var t=new Error("".concat(e," \n").concat(null===n||void 0===n?void 0:n.message));throw t.name="DATABASE_ERROR",t},f=function(n,e,t){return"".concat(n,"_").concat(e,"_").concat(t)},d=function(n){try{if(n)return o().fromDeviceID(Number(n))}catch(e){return void console.log(e)}},m=function(n,e){var t,r;return n&&e?null===(t=o()[n])||void 0===t||null===(r=t.parameters)||void 0===r?void 0:r.map((function(n){return(0,i.Z)((0,i.Z)({},n),{},{value:e[n.label]})})):void 0},v=function(){var n=(0,c.Z)((0,r.Z)().mark((function n(e){return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,a.Z)(s.GZ).getAll({startkey:"".concat(e),endkey:"".concat(e,"\uffff")}).then((function(n){return n.rows.map((function(n){return n.doc}))})).catch((function(n){return l(n,"Get locally saved devices error")})));case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),p=function(){var n=(0,c.Z)((0,r.Z)().mark((function n(e){return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,a.Z)(s.GZ).get(e).catch((function(n){return l(n,"Get device error")})));case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),h=function(){var n=(0,c.Z)((0,r.Z)().mark((function n(e){return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,a.Z)(s.GZ).update(e).catch((function(n){return l(n,"Update device error")})));case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),x=function(n){return(0,a.Z)(s.GZ).remove(n).catch((function(n){return l(n,"Delete device error")}))},w=function(n){return(0,a.Z)(s.GZ).put(n).catch((function(n){return"conflict"===n.name?l(n,"Device name must be unique"):l(n,"Insert device error")}))},Z=function(n,e){return(0,a.Z)(n).put((0,i.Z)({_id:Date.now().toString()},e))},g=function(n){return(0,a.Z)(n).getAll({descending:!0}).then((function(n){return n.rows.map((function(n){return n.doc}))}))},b=function(n,e,t){return(0,a.Z)(n).getAll({descending:!0,skip:(e-1)*t,limit:t}).then((function(n){return n.rows.map((function(n){return n.doc}))}))},j=function(n){return(0,a.Z)(n).getAll({include_docs:!1}).then((function(n){return n.total_rows}))},N=function(n){return(0,a.Z)(n).getAll({descending:!0,limit:1}).then((function(n){return n.rows.map((function(n){return n.doc}))}))},k=function(n){return(0,a.Z)(n).destroy()},y=function(n,e,t){return(0,a.Z)(n).listenToChanges(e,t)},_=function(n){return(0,a.Z)(n).close()}},8433:function(n,e,t){"use strict";t.d(e,{JG:function(){return m},d9:function(){return f},nE:function(){return d},wc:function(){return v},xf:function(){return p}});var r=t(4165),c=t(5861),i=t(763),u=t(8231),o=t(7104),a=t(8808),s=1e3,l=new u.w(navigator.serial),f=function(n){var e=n.id,t=n.name,r=(0,a.xN)(e);return{_id:(0,a.d9)(o.me.local,null===r||void 0===r?void 0:r.kind,e),id:e,name:t||"".concat(null===r||void 0===r?void 0:r.kind,"-").concat(e),kind:r}},d=function(){var n=(0,c.Z)((0,r.Z)().mark((function n(){return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,l.requestDevices();case 2:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),m=function(){var n=(0,c.Z)((0,r.Z)().mark((function n(){var e;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,l.updateDevices();case 2:return n.next=4,l.getDevicesList({ready:!0});case 4:return e=n.sent,n.abrupt("return",e);case 6:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),v=function(){var n=(0,c.Z)((0,r.Z)().mark((function n(e){var t,u,o=arguments;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=o.length>1&&void 0!==o[1]?o[1]:s,u=setInterval((0,c.Z)((0,r.Z)().mark((function n(){var t;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,m();case 2:t=n.sent,(0,i.isFunction)(e)&&e(t);case 4:case"end":return n.stop()}}),n)}))),t),n.abrupt("return",u);case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),p=function(){var n=(0,c.Z)((0,r.Z)().mark((function n(e,t){return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,l.sendCommand(e,t);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()},5963:function(n,e,t){"use strict";t.d(e,{E:function(){return c},e:function(){return r}});var r=function(n,e){var t;return n.filter((t=e,function(n){return 0===t.filter((function(e){return e.id===n.id})).length}))},c=function(n){var e=Math.floor(n/1e3%60),t=Math.floor(n/6e4%60),r=Math.floor(n/36e5%24),c="".concat(e,"s");return r?c="".concat(r,"h ").concat(t,"m ")+c:t&&(c="".concat(t,"m ")+c),c}},5525:function(){}}]);
//# sourceMappingURL=275.40688531.chunk.js.map