(this["webpackJsonpbioreactor-ui"]=this["webpackJsonpbioreactor-ui"]||[]).push([[8],{109:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(4),c=n(15),r=n(0);function s(){var e=Object(c.K)(),t=function(t,n,c){var s=c.textColor,i=c.Icon,l=c.timeout;e.addNotification({title:Object(r.jsx)("span",{className:Object(a.a)("text-base font-semibold",s+"500"),children:t}),content:Object(r.jsx)("span",{className:"text-sm text-neutral-500",children:n}),icon:Object(r.jsx)(i,{className:Object(a.a)("w-8 h-8",s+"600")})},l)};return{addErrorNotification:function(e,n){t(e,n,{textColor:"text-danger-",Icon:c.E,timeout:5e3})},addWarningNotification:function(e,n){t(e,n,{textColor:"text-warning-",Icon:c.E,timeout:2500})},addInfoNotification:function(e,n){t(e,n,{textColor:"text-primary-",Icon:c.v,timeout:1e3})}}}},384:function(e,t,n){"use strict";n.r(t);var a=n(35),c=n.n(a),r=n(44),s=n(6),i=n(2),l=n(135),o=n(15),u=n(109),d=n(90),f=n(375),m=new f.a(navigator.serial),v=function(){var e=Object(r.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.requestDevices();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=Object(r.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.updateDevices();case 2:return e.next=4,m.getDevicesList({ready:!0});case 4:return t=e.sent,e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),b=function(){var e=Object(r.a)(c.a.mark((function e(t){var n,a,s=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:3e3,a=setInterval(Object(r.a)(c.a.mark((function e(){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x();case 2:n=e.sent,Object(d.isFunction)(t)&&t(n);case 4:case"end":return e.stop()}}),e)}))),n),e.abrupt("return",a);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),j={requestDevices:v,getConnectedDevices:x,continuousUpdateDevices:b,sendCommand:function(){var e=Object(r.a)(c.a.mark((function e(t,n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.sendCommand(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},p=n(92),h=n(0),O=p.e.map((function(e){return{label:e,type:"option"}})),w=function(e){var t=e.device,n=void 0===t?{label:"--"}:t,a=e.deviceType,l=void 0===a?O.filter((function(e){return"SimpleSpectro"===e.label}))[0]:a,d=e.onSelectDevice,f=e.onSelectType,m=Object(u.a)(),v=m.addInfoNotification,x=m.addWarningNotification,b=Object(i.useState)([]),p=Object(s.a)(b,2),w=p[0],y=p[1];Object(i.useEffect)((function(){f(l)}),[]),Object(i.useEffect)((function(){N();var e=j.continuousUpdateDevices((function(e){g(e)}));return function(){return e.then((function(e){return clearInterval(e)}))}}),[w.length]);var N=function(){var e=Object(r.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.getConnectedDevices();case 2:(t=e.sent).length>0&&((null===n||void 0===n?void 0:n.id)||d(S(t)[0]),y(t));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=function(e){e.length>w.length?(v("New device connected"),(null===n||void 0===n?void 0:n.id)||d(S(e)[0])):e.length<w.length&&(x("Device disconnected"),0===e.length&&d({label:"--"})),y(e)},k=function(){var e=Object(r.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.activeElement.blur(),e.next=3,j.requestDevices();case 3:return e.next=5,j.getConnectedDevices();case 5:t=e.sent,g(t);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=function(e){return e.map((function(e){return{id:e.id,label:"Device-"+e.id,type:"option"}}))};return Object(h.jsxs)("div",{className:"m-4 py-3 px-4 flex flex-col-reverse sm:flex-row sm:justify-between sm:items-center rounded-md bg-white shadow ",children:[Object(h.jsxs)("div",{className:"flex flex-row flex-wrap justify-between",children:[Object(h.jsxs)("div",{className:"my-1 mx-2 w-full sm:w-max flex items-center justify-end flex-nowrap",children:[Object(h.jsx)("h3",{className:"mr-2 text-base font-medium text-neutral-800 ",children:"Device Type :"}),Object(h.jsx)(o.c,{title:l.label,options:[O],onSelect:f})]}),Object(h.jsxs)("div",{className:"my-1 mx-2 w-full sm:w-max flex items-center justify-end flex-nowrap",children:[Object(h.jsx)("h3",{className:"mr-2 text-base font-medium text-neutral-800",children:"Select device :"}),Object(h.jsx)(o.c,{title:n.label,options:[S(w)],onSelect:d})]})]}),Object(h.jsx)(o.a,{className:"mb-3 sm:mb-0",onClick:k,children:"Request device"})]})},y=n(4),N=function(e){var t=e.title,n=e.value,a=e.unit,c=e.placeholder,r=e.type,s=void 0===r?"text":r,i=e.editable,l=e.onChange,o=e.className;return Object(h.jsx)("div",{className:Object(y.a)("flex",o),children:Object(h.jsxs)("div",{className:"w-full m-1 p-2 flex flex-col justify-between items-center sm:items-start rounded-md bg-white shadow",children:[Object(h.jsx)("h3",{className:"py-1 text-sm font-medium text-gray-500",children:t}),Object(h.jsxs)("div",{className:"w-full mt-2 flex flex-row justify-center sm:justify-end items-center",children:[i?Object(h.jsx)("input",{className:"w-full p-1 bg-neutral-50 border-neutral-200 text-right text-black text-sm font-bold placeholder-neutral-500 placeholder-opacity-30 rounded  focus:outline-none focus:ring-0 leading-none",id:t,name:t,type:s,placeholder:c,value:n,onChange:function(e){return l(e.target.value)}}):Object(h.jsx)("p",{className:"text-xl font-bold text-black",children:n}),Object(h.jsx)("p",{className:"ml-1 text-sm font-medium text-gray-400",children:a})]})]})})},g=function(e){var t,n=e.data;return Object(h.jsxs)("div",{className:"flex flex-col",children:[(null===n||void 0===n?void 0:n.epoch)&&Object(h.jsxs)("p",{className:"m-2 text-base font-medium text-black self-end",children:["Awake time:",Object(h.jsx)("span",{className:"mx-1 text-sm text-neutral-500",children:(null===n||void 0===n?void 0:n.epoch)/1e3+"s"})]}),Object(h.jsx)("div",{className:" flex flex-row justify-around flex-wrap",children:null===n||void 0===n||null===(t=n.parametersArray)||void 0===t?void 0:t.map((function(e,t){return Object(h.jsx)(N,{title:e.name||e.label,value:e.value*e.factor,unit:e.unit,className:"w-full sm:w-1/2  md:w-1/3 lg:w-1/4 flex"},t)}))})]})},k=function(){return Object(h.jsx)("div",{})},S=n(89),C=n(1),D=function(e){var t=e.title;return Object(h.jsx)("div",{className:"my-4",children:Object(h.jsx)(o.b,{justify:"start",children:Object(h.jsx)("span",{className:"px-2 bg-white text-xs font-medium text-neutral-400",children:t})})})},I=[1,2,5,10].map((function(e){return{label:"".concat(e," s"),value:1e3*e,type:"option"}})),E=function(e){var t=e.device,n=e.data,a=e.refreshInterval,l=void 0===a?1e3:a,d=e.setRefreshInterval,f=Object(u.a)(),m=f.addInfoNotification,v=f.addErrorNotification,x=Object(i.useState)([]),b=Object(s.a)(x,2),O=b[0],w=b[1],y=Object(i.useState)({label:l/1e3+" s",value:l,type:"option"}),g=Object(s.a)(y,2),k=g[0],E=g[1],R=Object(i.useState)(!1),T=Object(s.a)(R,2),q=T[0],A=T[1],F=Object(i.useState)(!1),P=Object(s.a)(F,2),G=P[0],H=P[1];Object(i.useEffect)((function(){var e=null===n||void 0===n?void 0:n.parameters,t=e&&Object.keys(e).filter((function(t){return e[t].writable})).map((function(t){return Object(C.a)(Object(C.a)({},e[t]),{},{key:t})}));w(t)}),[q]);var J=function(){setTimeout((function(){A(!q)}),1e3)},U=function(){var e=Object(r.a)(c.a.mark((function e(){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.sendCommand(t.id,p.a.reset);case 3:n=e.sent,m(n),J(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),v(e.t0.message);case 11:document.activeElement.blur();case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),W=function(){var e=Object(r.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.sendCommand(t.id,p.a.sleep);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),v(e.t0.message);case 8:document.activeElement.blur();case 9:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}(),B=function(){var e=Object(r.a)(c.a.mark((function e(){var n,a,r,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:H(!0),n=!1,e.prev=2,a=Object(S.a)(O),e.prev=4,a.s();case 6:if((r=a.n()).done){e.next=15;break}if(!(s=r.value).edited){e.next=13;break}return console.log(s.key+s.value),e.next=12,j.sendCommand(t.id,p.a.setParameter(s.key,s.value));case 12:n=!0;case 13:e.next=6;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(4),a.e(e.t0);case 20:return e.prev=20,a.f(),e.finish(20);case 23:m(n?"Saved":"No changes to save"),J(),e.next=30;break;case 27:e.prev=27,e.t1=e.catch(2),v(e.t1.message);case 30:H(!1),document.activeElement.blur();case 32:case"end":return e.stop()}}),e,null,[[2,27],[4,17,20,23]])})));return function(){return e.apply(this,arguments)}}();return Object(h.jsxs)("div",{className:"w-full flex flex-col ",children:[Object(h.jsxs)("div",{className:"mt-2 flex flex-col sm:flex-row justify-between",children:[Object(h.jsxs)("div",{className:"my-1 mx-2 flex flex-row items-center justify-end",children:[Object(h.jsx)("p",{className:"mx-1 text-sm font-medium text-neutral-700",children:"Refresh inreval :"}),Object(h.jsx)(o.c,{title:k.label,options:[I],onSelect:function(e){E(e),d(e.value),document.activeElement.blur()}})]}),Object(h.jsxs)("div",{className:"my-1 flex flex-row justify-end",children:[Object(h.jsx)(o.a,{className:"mx-2",variant:"white",onClick:W,children:"Sleep"}),Object(h.jsx)(o.a,{className:"mx-2 ",variant:"white",onClick:U,children:"Reset Device"})]})]}),(null===O||void 0===O?void 0:O.length)>0&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(D,{title:"Edit parameters"}),Object(h.jsx)("div",{className:"flex flex-row justify-start flex-wrap",children:O.map((function(e,t){return Object(h.jsx)(N,{title:e.name||e.label,value:e.value*e.factor,placeholder:e.description,unit:e.unit,editable:!0,onChange:function(t){return function(e,t){var n=O.map((function(n){return n.label===e?Object(C.a)(Object(C.a)({},n),{},{value:t/n.factor,edited:!0}):n}));w(n)}(e.label,t)},className:"w-full sm:w-1/2  md:w-1/3 lg:w-1/4 flex"},t)}))}),Object(h.jsxs)(o.a,{className:"mx-2 mt-2 flex self-end",variant:"white",onClick:B,children:[G&&Object(h.jsx)(o.l,{className:"text-primary-600 w-5 mr-2"}),"Save"]})]})]})},R=["General","History","Configuration"].map((function(e){return{value:e,label:e}}));t.default=function(){var e=Object(i.useState)(),t=Object(s.a)(e,2),n=t[0],a=t[1],d=Object(i.useState)(),f=Object(s.a)(d,2),m=f[0],v=f[1],x=Object(i.useState)(R[0]),b=Object(s.a)(x,2),O=b[0],y=b[1],N=Object(i.useState)({}),S=Object(s.a)(N,2),C=S[0],D=S[1],I=Object(i.useState)(1e3),T=Object(s.a)(I,2),q=T[0],A=T[1],F=Object(u.a)().addErrorNotification;Object(i.useEffect)((function(){if(null===n||void 0===n?void 0:n.id){var e=setInterval((function(){return P(null===n||void 0===n?void 0:n.id)}),q);return function(){clearInterval(e)}}}),[q,null===n||void 0===n?void 0:n.id,null===m||void 0===m?void 0:m.label]);var P=function(){var e=Object(r.a)(c.a.mark((function e(t){var n,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=14;break}return e.prev=1,e.next=4,j.sendCommand(t,p.a.compactSettings);case 4:n=e.sent,a=Object(l.parseCurrentSettings)(n,{kind:null===m||void 0===m?void 0:m.label,parameterInfo:!0,parametersArray:!0}),D(a),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),F(e.t0.message);case 12:e.next=15;break;case 14:D({});case 15:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(w,{deviceType:m,onSelectType:v,device:n,onSelectDevice:function(e){a(e),P(null===e||void 0===e?void 0:e.id)}}),(null===n||void 0===n?void 0:n.id)?Object(h.jsxs)("div",{className:"mx-4 pb-4",children:[Object(h.jsx)(o.f,{onSelect:y,selected:O,options:R}),Object(h.jsx)("div",{className:"p-3 mt-4 sm:m-0 flex flex-col items-center rounded-md sm:rounded-t-none bg-white shadow ",children:function(e){switch(e.value){case"General":return Object(h.jsx)(g,{data:C});case"History":return Object(h.jsx)(k,{device:n});case"Configuration":return Object(h.jsx)(E,{device:n,data:C,refreshInterval:q,setRefreshInterval:A});default:return Object(h.jsx)("div",{})}}(O)})]}):Object(h.jsxs)("div",{className:"mx-5 mt-16 flex flex-col items-center",children:[Object(h.jsx)("h3",{className:"text-base font-bold text-gray-300 leading-loose",children:"No connected Device"}),Object(h.jsx)("h3",{className:"text-sm font-base text-gray-300",children:"Please plug your device into the computer"})]})]})}},92:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return i})),n.d(t,"f",(function(){return l})),n.d(t,"e",(function(){return o})),n.d(t,"a",(function(){return u}));var a=n(102),c=n.n(a),r="BIOREACTOR_devices",s="9001",i="tcp",l=["tcp","http"],o=Object.keys(c.a).map((function(e){return c.a[e].kind})),u={compactSettings:"uc",reset:"ur1234",sleep:"l",setParameter:function(e,t){return"".concat(e).concat(t)}}}}]);
//# sourceMappingURL=8.dbf85d4d.chunk.js.map