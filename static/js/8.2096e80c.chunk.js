(this["webpackJsonpbioreactor-ui"]=this["webpackJsonpbioreactor-ui"]||[]).push([[8],{103:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(4),c=n(15),r=n(0);function i(){var e=Object(c.M)(),t=function(t,n,c){var i=c.textColor,s=c.Icon,l=c.timeout;e.addNotification({title:Object(r.jsx)("span",{className:Object(a.a)("text-base font-semibold",i+"500"),children:t}),content:Object(r.jsx)("span",{className:"text-sm text-neutral-500",children:n}),icon:Object(r.jsx)(s,{className:Object(a.a)("w-8 h-8",i+"600")})},l)};return{addErrorNotification:function(e,n){t(e,n,{textColor:"text-danger-",Icon:c.E,timeout:5e3})},addWarningNotification:function(e,n){t(e,n,{textColor:"text-warning-",Icon:c.E,timeout:2500})},addInfoNotification:function(e,n){t(e,n,{textColor:"text-primary-",Icon:c.v,timeout:1e3})}}}},384:function(e,t,n){"use strict";n.r(t);var a=n(35),c=n.n(a),r=n(20),i=n(44),s=n(6),l=n(2),o=n(135),u=n(15),d=n(103),f=n(91),m=n(375),v=new m.a(navigator.serial),b=function(){var e=Object(i.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.requestDevices();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=function(){var e=Object(i.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.updateDevices();case 2:return e.next=4,v.getDevicesList({ready:!0});case 4:return t=e.sent,e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=Object(i.a)(c.a.mark((function e(t){var n,a,r=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:3e3,a=setInterval(Object(i.a)(c.a.mark((function e(){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j();case 2:n=e.sent,Object(f.isFunction)(t)&&t(n);case 4:case"end":return e.stop()}}),e)}))),n),e.abrupt("return",a);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p={requestDevices:b,getConnectedDevices:j,continuousUpdateDevices:x,sendCommand:function(){var e=Object(i.a)(c.a.mark((function e(t,n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.sendCommand(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},O=n(90),h=n(0),w=O.e.map((function(e){return{label:e,type:"option"}})),y=function(e){var t=e.device,n=void 0===t?{label:"--"}:t,a=e.deviceType,r=void 0===a?w.filter((function(e){return"SimpleSpectro"===e.label}))[0]:a,o=e.onSelectDevice,f=e.onSelectType,m=Object(d.a)(),v=m.addInfoNotification,b=m.addWarningNotification,j=Object(l.useState)([]),x=Object(s.a)(j,2),O=x[0],y=x[1];Object(l.useEffect)((function(){f(r)}),[]),Object(l.useEffect)((function(){N();var e=p.continuousUpdateDevices((function(e){g(e)}));return function(){return e.then((function(e){return clearInterval(e)}))}}),[O.length]);var N=function(){var e=Object(i.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.getConnectedDevices();case 2:(t=e.sent).length>0&&((null===n||void 0===n?void 0:n.id)||o(C(t)[0]),y(t));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=function(e){e.length>O.length?(v("New device connected"),(null===n||void 0===n?void 0:n.id)||o(C(e)[0])):e.length<O.length&&(b("Device disconnected"),0===e.length&&o({label:"--"})),y(e)},k=function(){var e=Object(i.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.activeElement.blur(),e.next=3,p.requestDevices();case 3:return e.next=5,p.getConnectedDevices();case 5:t=e.sent,g(t);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),C=function(e){return e.map((function(e){return{id:e.id,label:"Device-"+e.id,type:"option"}}))};return Object(h.jsxs)("div",{className:"m-4 py-3 px-4 flex flex-col-reverse sm:flex-row sm:justify-between sm:items-center rounded-md bg-white shadow ",children:[Object(h.jsxs)("div",{className:"flex flex-row flex-wrap justify-between",children:[Object(h.jsxs)("div",{className:"my-1 mx-2 w-full sm:w-max flex items-center justify-end flex-nowrap",children:[Object(h.jsx)("h3",{className:"mr-2 text-base font-medium text-neutral-800 ",children:"Device Type :"}),Object(h.jsx)(u.c,{title:r.label,options:[w],onSelect:f})]}),Object(h.jsxs)("div",{className:"my-1 mx-2 w-full sm:w-max flex items-center justify-end flex-nowrap",children:[Object(h.jsx)("h3",{className:"mr-2 text-base font-medium text-neutral-800",children:"Select device :"}),Object(h.jsx)(u.c,{title:n.label,options:[C(O)],onSelect:o})]})]}),Object(h.jsx)(u.a,{className:"mb-3 sm:mb-0",onClick:k,children:"Request device"})]})},N=function(e){var t=e.title;return Object(h.jsx)("div",{className:"my-4",children:Object(h.jsx)(u.b,{justify:"start",children:Object(h.jsx)("span",{className:"px-2 bg-white text-xs font-medium text-neutral-400",children:t})})})},g=n(4),k=function(e){var t=e.title,n=e.value,a=e.unit,c=e.placeholder,r=e.type,i=void 0===r?"text":r,s=e.editable,l=e.onChange,o=e.className;return Object(h.jsx)("div",{className:Object(g.a)("flex",o),children:Object(h.jsxs)("div",{className:"w-full m-1 p-2 flex flex-col justify-between items-center sm:items-start rounded-md bg-white shadow",children:[Object(h.jsx)("h3",{className:"py-1 text-sm font-medium text-gray-500",children:t}),Object(h.jsxs)("div",{className:"w-full mt-2 flex flex-row justify-center sm:justify-end items-center",children:[s?Object(h.jsx)("input",{className:"w-full p-1 bg-neutral-50 border-neutral-200 text-right text-black text-sm font-bold placeholder-neutral-500 placeholder-opacity-30 rounded  focus:outline-none focus:ring-0 leading-none",id:t,name:t,type:i,placeholder:c,value:n,onChange:function(e){return l(e.target.value)}}):Object(h.jsx)("p",{className:"text-xl font-bold text-black",children:n}),Object(h.jsx)("p",{className:"ml-1 text-sm font-medium text-gray-400",children:a})]})]})})},C=function(e){var t,n=e.data,a=e.device,r=Object(d.a)(),s=r.addInfoNotification,l=r.addErrorNotification,o=function(){var e=Object(i.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.sendCommand(a.id,t);case 3:n=e.sent,console.log("runExpirement"),console.log(n),s(n),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("runExpirement error"),console.log(e.t0),l(e.t0);case 14:document.activeElement.blur();case 15:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsxs)("div",{className:"flex flex-col mt-2",children:[Object(h.jsxs)("div",{className:"flex flex-row justify-end",children:[Object(h.jsx)(u.a,{className:"mx-2",onClick:function(){return o(O.a.runExpirement)},children:"Run experiment"}),Object(h.jsx)(u.a,{className:"mx-2",onClick:function(){return o(O.a.kinetic)},children:"Run Kinetic"})]}),(null===n||void 0===n?void 0:n.epoch)&&Object(h.jsx)(N,{title:Object(h.jsxs)("p",{className:" text-base font-medium text-black self-start",children:["Awake time:",Object(h.jsx)("span",{className:"mx-1 text-sm text-neutral-500",children:(null===n||void 0===n?void 0:n.epoch)/1e3+"s"})]})}),Object(h.jsx)("div",{className:" flex flex-row justify-around flex-wrap",children:null===n||void 0===n||null===(t=n.parametersArray)||void 0===t?void 0:t.map((function(e,t){return Object(h.jsx)(k,{title:e.name||e.label,value:e.value*e.factor,unit:e.unit,className:"w-full sm:w-1/2  md:w-1/3 lg:w-1/4 flex"},t)}))})]})},S=n(1),E=function(e){var t=e.data,n=e.deviceType,a=Object(l.useState)([]),c=Object(s.a)(a,2),i=c[0],o=c[1];Object(l.useEffect)((function(){var e,n=t&&t.length>0?null===(e=t[0].parametersArray)||void 0===e?void 0:e.map((function(e){return e.name||e.label})):[];o(["Epoch"].concat(Object(r.a)(n)))}),[n]);var d=Object(l.useCallback)((function(e){var t,n="text-xs text-center p-2";return Object(h.jsxs)("tr",{children:[Object(h.jsx)(u.H,{compact:!0,className:n+" font-medium",children:e.value.epoch}),null===(t=e.value.parametersArray)||void 0===t?void 0:t.map((function(e,t){return Object(h.jsx)(u.H,{compact:!0,className:n,children:e.value},t)}))]})}),[]),f=Object(l.useCallback)((function(){return Object(h.jsx)("tr",{children:null===i||void 0===i?void 0:i.map((function(e){return Object(h.jsx)(u.I,{className:"p-2 text-center font-normal normal-case",compact:!0,children:e},e)}))})}),[i]),m=Object(u.N)(t,{itemsPerPage:10,withText:!0}),v=m.pagination,b=m.data;return Object(h.jsx)("div",{className:"w-full p-1 overflow-x-auto",children:Object(h.jsx)(u.G,{pagination:v,data:b.map((function(e){return Object(S.a)(Object(S.a)({},e),{},{id:e.epoch})})),Header:f,Tr:d})})},I=n(89),D=[1,2,5,10,30,60,120,300].map((function(e){return{label:e>59?"".concat(e/60," m"):"".concat(e," s"),value:1e3*e,type:"option"}})),T=function(e){var t=e.device,n=e.data,a=e.refreshInterval,r=void 0===a?1e3:a,o=e.setRefreshInterval,f=Object(d.a)(),m=f.addInfoNotification,v=f.addErrorNotification,b=Object(l.useState)([]),j=Object(s.a)(b,2),x=j[0],w=j[1],y=Object(l.useState)({label:r/1e3+" s",value:r,type:"option"}),g=Object(s.a)(y,2),C=g[0],E=g[1],T=Object(l.useState)(!1),R=Object(s.a)(T,2),A=R[0],H=R[1],P=Object(l.useState)(!1),q=Object(s.a)(P,2),F=q[0],G=q[1];Object(l.useEffect)((function(){var e=null===n||void 0===n?void 0:n.parameters,t=e&&Object.keys(e).filter((function(t){return e[t].writable})).map((function(t){return Object(S.a)(Object(S.a)({},e[t]),{},{key:t})}));w(t)}),[A]);var J=function(){setTimeout((function(){H(!A)}),1e3)},U=function(){var e=Object(i.a)(c.a.mark((function e(){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.sendCommand(t.id,O.a.reset);case 3:n=e.sent,m(n),J(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),v(e.t0.message);case 11:document.activeElement.blur();case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),W=function(){var e=Object(i.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.sendCommand(t.id,O.a.sleep);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),v(e.t0.message);case 8:document.activeElement.blur();case 9:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}(),B=function(){var e=Object(i.a)(c.a.mark((function e(){var n,a,r,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:G(!0),n=!1,e.prev=2,a=Object(I.a)(x),e.prev=4,a.s();case 6:if((r=a.n()).done){e.next=15;break}if(!(i=r.value).edited){e.next=13;break}return console.log(i.key+i.value),e.next=12,p.sendCommand(t.id,O.a.setParameter(i.key,i.value));case 12:n=!0;case 13:e.next=6;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(4),a.e(e.t0);case 20:return e.prev=20,a.f(),e.finish(20);case 23:m(n?"Saved":"No changes to save"),J(),e.next=30;break;case 27:e.prev=27,e.t1=e.catch(2),v(e.t1.message);case 30:G(!1),document.activeElement.blur();case 32:case"end":return e.stop()}}),e,null,[[2,27],[4,17,20,23]])})));return function(){return e.apply(this,arguments)}}();return Object(h.jsxs)("div",{className:"w-full flex flex-col ",children:[Object(h.jsxs)("div",{className:"mt-2 flex flex-col sm:flex-row justify-between",children:[Object(h.jsxs)("div",{className:"my-1 mx-2 flex flex-row items-center justify-end",children:[Object(h.jsx)("p",{className:"mx-1 text-sm font-medium text-neutral-700",children:"Refresh inreval :"}),Object(h.jsx)(u.c,{title:C.label,options:[D],onSelect:function(e){E(e),o(e.value),document.activeElement.blur()}})]}),Object(h.jsxs)("div",{className:"my-1 flex flex-row justify-end",children:[Object(h.jsx)(u.a,{className:"mx-2",variant:"white",onClick:W,children:"Sleep"}),Object(h.jsx)(u.a,{className:"mx-2 ",variant:"white",onClick:U,children:"Reset Device"})]})]}),(null===x||void 0===x?void 0:x.length)>0&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(N,{title:"Edit parameters"}),Object(h.jsx)("div",{className:"flex flex-row justify-start flex-wrap",children:x.map((function(e,t){return Object(h.jsx)(k,{title:e.name||e.label,value:e.value*e.factor,placeholder:e.description,unit:e.unit,editable:!0,onChange:function(t){return function(e,t){var n=x.map((function(n){return n.label===e?Object(S.a)(Object(S.a)({},n),{},{value:t/n.factor,edited:!0}):n}));w(n)}(e.label,t)},className:"w-full sm:w-1/2  md:w-1/3 lg:w-1/4 flex"},t)}))}),Object(h.jsxs)(u.a,{className:"mx-2 mt-2 flex self-end",variant:"white",onClick:B,children:[F&&Object(h.jsx)(u.l,{className:"text-primary-600 w-5 mr-2"}),"Save"]})]})]})},R=["General","History","Configuration"].map((function(e){return{value:e,label:e}}));t.default=function(){var e=Object(l.useState)(),t=Object(s.a)(e,2),n=t[0],a=t[1],f=Object(l.useState)(),m=Object(s.a)(f,2),v=m[0],b=m[1],j=Object(l.useState)(R[0]),x=Object(s.a)(j,2),w=x[0],N=x[1],g=Object(l.useState)({}),k=Object(s.a)(g,2),S=k[0],I=k[1],D=Object(l.useState)([]),A=Object(s.a)(D,2),H=A[0],P=A[1],q=Object(l.useState)(1e4),F=Object(s.a)(q,2),G=F[0],J=F[1],U=Object(d.a)().addErrorNotification,W=Object(l.useCallback)(function(){var e=Object(i.a)(c.a.mark((function e(t){var n,a,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=17;break}return e.prev=1,e.next=4,p.sendCommand(t,O.a.compactSettings);case 4:n=e.sent,a=Object(o.parseCurrentSettings)(n,{kind:null===v||void 0===v?void 0:v.label,parameterInfo:!0,parametersArray:!0}),I(a),i=[a].concat(Object(r.a)(H)),console.log(i),P(i),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),U(e.t0.message);case 15:e.next=18;break;case 17:I({});case 18:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),[H,null===v||void 0===v?void 0:v.label,null===n||void 0===n?void 0:n.id]);Object(l.useEffect)((function(){if(null===n||void 0===n?void 0:n.id){var e=setInterval((function(){return W(null===n||void 0===n?void 0:n.id)}),G);return function(){clearInterval(e)}}}),[G,W]),Object(l.useEffect)((function(){P([]),W(null===n||void 0===n?void 0:n.id)}),[null===v||void 0===v?void 0:v.label,null===n||void 0===n?void 0:n.id]);return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(y,{deviceType:v,onSelectType:b,device:n,onSelectDevice:function(e){a(e),W(null===e||void 0===e?void 0:e.id)}}),(null===n||void 0===n?void 0:n.id)?Object(h.jsxs)("div",{className:"mx-4 pb-4",children:[Object(h.jsx)(u.f,{onSelect:N,selected:w,options:R}),Object(h.jsx)("div",{className:"p-3 mt-4 sm:m-0 flex flex-col items-center rounded-md sm:rounded-t-none bg-white shadow ",children:function(e){switch(e.value){case"General":return Object(h.jsx)(C,{data:S,device:n});case"History":return Object(h.jsx)(E,{data:H,deviceType:null===v||void 0===v?void 0:v.label});case"Configuration":return Object(h.jsx)(T,{device:n,data:S,refreshInterval:G,setRefreshInterval:J});default:return Object(h.jsx)("div",{})}}(w)})]}):Object(h.jsxs)("div",{className:"mx-5 mt-16 flex flex-col items-center",children:[Object(h.jsx)("h3",{className:"text-base font-bold text-gray-300 leading-loose",children:"No connected Device"}),Object(h.jsx)("h3",{className:"text-sm font-base text-gray-300",children:"Please plug your device into the computer"})]})]})}},90:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"e",(function(){return o})),n.d(t,"a",(function(){return u}));var a=n(102),c=n.n(a),r="BIOREACTOR_devices",i="9001",s="tcp",l=["tcp","http","wss"],o=Object.keys(c.a).map((function(e){return c.a[e].kind})),u={compactSettings:"uc",runExpirement:"r",kinetic:"k",reset:"ur1234",sleep:"l",setParameter:function(e,t){return"".concat(e).concat(t)}}}}]);
//# sourceMappingURL=8.2096e80c.chunk.js.map